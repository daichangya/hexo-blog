---
title: Javaç¼–ç¨‹ï¼šå¸¸è§é—®é¢˜æ±‡æ€»
id: 1044
date: 2024-10-31 22:01:48
author: daichangya
excerpt: è¯¥é¡µé¢æ”¶é›†äº†ä¸€äº›ä¸å¥½çš„ä»£ç ï¼Œå¯¹äºåˆå­¦è€…æ¥è¯´çœ‹èµ·æ¥ä¼¼ä¹å¹¶ä¸é‚£ä¹ˆç³Ÿç³•ã€‚åˆå­¦è€…ç»å¸¸åœ¨è¯­è¨€è¯­æ³•ä¸ŠæŒ£æ‰ã€‚ä»–ä»¬å¯¹æ ‡å‡†JDKç±»åº“ä»¥åŠå¦‚ä½•æœ€å¥½åœ°åˆ©ç”¨å®ƒä¹Ÿä¸äº†è§£ã€‚å®é™…ä¸Šï¼Œæˆ‘å·²ç»ä»æ—¥å¸¸åˆçº§ä»£ç ä¸­æ”¶é›†äº†æ‰€æœ‰ç¤ºä¾‹ã€‚æˆ‘å·²ç»ä¿®æ”¹äº†åŸå§‹ä»£ç ï¼Œä¸ºå®ƒæä¾›äº†ç¤ºä¾‹å­—ç¬¦ï¼Œä»è€Œçªå‡ºäº†é—®é¢˜æ‰€åœ¨ã€‚SonarQubeå¯ä»¥å¾ˆå®¹æ˜“åœ°å‘ç°è®¸å¤šè¿™äº›é—®é¢˜ã€‚æˆ‘å¼ºçƒˆæ¨èæ­¤å·¥å…·ã€‚
permalink: /archives/Java-bian-cheng-chang-jian-wen-ti-hui/
categories:
- java
---

Javaåæ¨¡å¼
=======

è¯¥é¡µé¢æ”¶é›†äº†ä¸€äº›ä¸å¥½çš„ä»£ç ï¼Œå¯¹äºåˆå­¦è€…æ¥è¯´çœ‹èµ·æ¥ä¼¼ä¹å¹¶ä¸é‚£ä¹ˆç³Ÿç³•ã€‚åˆå­¦è€…ç»å¸¸åœ¨è¯­è¨€è¯­æ³•ä¸ŠæŒ£æ‰ã€‚ä»–ä»¬å¯¹æ ‡å‡†JDKç±»åº“ä»¥åŠå¦‚ä½•æœ€å¥½åœ°åˆ©ç”¨å®ƒä¹Ÿä¸äº†è§£ã€‚å®é™…ä¸Šï¼Œæˆ‘å·²ç»ä»æ—¥å¸¸åˆçº§ä»£ç ä¸­æ”¶é›†äº†æ‰€æœ‰ç¤ºä¾‹ã€‚æˆ‘å·²ç»ä¿®æ”¹äº†åŸå§‹ä»£ç ï¼Œä¸ºå®ƒæä¾›äº†ç¤ºä¾‹å­—ç¬¦ï¼Œä»è€Œçªå‡ºäº†é—®é¢˜æ‰€åœ¨ã€‚[SonarQube](http://www.sonarsource.com/)å¯ä»¥å¾ˆå®¹æ˜“åœ°å‘ç°è®¸å¤šè¿™äº›é—®é¢˜ã€‚æˆ‘å¼ºçƒˆæ¨èæ­¤å·¥å…·ã€‚

å…¶ä¸­ä¸€äº›å¯èƒ½çœ‹èµ·æ¥åƒå¾®ä¼˜åŒ–ï¼Œä¸å¸¦æ¦‚è¦åˆ†æçš„è¿‡æ—©ä¼˜åŒ–æˆ–æ’å®šå› å­ä¼˜åŒ–ã€‚ä½†æ˜¯ï¼Œåœ¨æˆåƒä¸Šä¸‡ä¸ªè¿™æ ·çš„å°åœ°æ–¹æµªè´¹çš„æ€§èƒ½å’Œå†…å­˜å¾ˆå¿«å°±ä¼šç´¯ç§¯èµ·æ¥ï¼Œå¹¶å°†ä½¿åº”ç”¨ç¨‹åºå˜å¾—è¶Šæ¥è¶Šå›°éš¾ã€‚å½“æˆ‘è¯´åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘æŒ‡çš„æ˜¯åœ¨åº”ç”¨ç¨‹åºæœåŠ¡å™¨ä¸Šè¿è¡Œçš„æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºã€‚é‚£å°±æ˜¯æˆ‘çš„ç”Ÿè®¡ã€‚åœ¨æ¡Œé¢GUIåº”ç”¨ç¨‹åºä¸Šï¼Œæƒ…å†µå¯èƒ½æ²¡æœ‰é‚£ä¹ˆç³Ÿã€‚ä½†æ˜¯ï¼Œè¿è¡Œå®¢æˆ·ç«¯Javaåº”ç”¨ç¨‹åºçš„å”¯ä¸€ç›¸å…³å¹³å°æ˜¯ä»€ä¹ˆï¼Ÿå®‰å“ å…·æœ‰éå¸¸æœ‰é™çš„èµ„æºï¼ˆå†…å­˜ï¼ï¼‰çš„åµŒå…¥å¼å¹³å°ã€‚åœ¨è¿™é‡Œï¼Œå³ä½¿æ’â€‹â€‹å®šå› å­ä¼˜åŒ–ä¹Ÿèƒ½å¾ˆå¿«è·å¾—å›æŠ¥ã€‚å°±åƒéå†æ•°ç»„è€Œä¸æ˜¯åˆ—è¡¨ä¸€æ ·ã€‚

å¦‚æœæ‚¨å¯¹å¦‚ä½•å‹å¥½åœ°ç»˜åˆ¶å›¾æ„Ÿå…´è¶£ï¼Œè¯·æŸ¥çœ‹ [JDK Performance Wiki](https://wiki.openjdk.java.net/display/HotSpot/PerformanceTechniques)ã€‚

æœ€åï¼Œæ‚¨çš„åº”ç”¨ç¨‹åºçš„å¾ˆå¤šæ€§èƒ½å–å†³äºä»£ç çš„æ•´ä½“è´¨é‡ã€‚é¡ºä¾¿è¯´ä¸€å¥ï¼Œæ‚¨æ°¸è¿œä¸è¦ä½ä¼°å†…å­˜å ç”¨çš„é‡è¦æ€§ã€‚æˆ‘ä¸èƒ½é‚£ä¹ˆå¼ºè°ƒã€‚æˆ‘çœ‹åˆ°å¤ªå¤šçš„åº”ç”¨ç¨‹åºå…·æœ‰ç–¯ç‹‚çš„åƒåœ¾å›æ”¶å¼€é”€å’Œå†…å­˜ä¸è¶³é”™è¯¯ã€‚å°½ç®¡åƒåœ¾å›æ”¶éå¸¸å¿«ï¼Œä½†æ˜¯å¤§å¤šæ•°æœåŠ¡å™¨ç«¯ä»£ç çš„å¯ä¼¸ç¼©æ€§ä¸»è¦å—åˆ¶äºå¹¶é™åˆ¶äº†_æ¯ä¸ªè¯·æ±‚/äº‹åŠ¡çš„å†…å­˜ä½¿ç”¨é‡_å’Œ_è¯·æ±‚/äº‹åŠ¡æŒç»­æ—¶é—´_ã€‚å°†è¿™äº›å‚æ•°ä¸­çš„ä»»ä½•ä¸€ä¸ªæé«˜ä¸€ä¸ªå¸¸æ•°éƒ½å°†ç›´æ¥ä¸ºæ‚¨å¸¦æ¥æ›´é«˜çš„ååé‡ã€‚å¦‚æœç³»æ•°æ˜¯10ï¼Œåˆ™æ„å‘³ç€è¦æ”¯æŒ100æˆ–1000ä¸ªç”¨æˆ·ï¼Œè¿™å¯èƒ½å¯¹æ‚¨çš„å®¢æˆ·æœ‰æ‰€ä¸åŒã€‚

æ¯”è¾ƒä»¥ä¸‹æƒ…å†µï¼ˆå‡è®¾å¹´è½»ä¸€ä»£ä¸º100MBï¼‰ï¼š
| Scenario   | thread pool | tx duration | => max\. tx / s | mem / tx | => garbage / min | GC / min |
|------------|-------------|-------------|-----------------|----------|------------------|----------|
| base       | 30          | 100 ms      | 300             | 50 KB    | 900 MB           | 9        |
| slower     | 30          | 1000 ms     | 30              | 50 KB    | 90 MB            | 0\.9     |
| more mem   | 30          | 100 ms      | 300             | 500 KB   | 9 GB             | 90       |
| excess mem | 30          | 100 ms      | 300             | 5 MB     | 90 GB            | 900      |


åœ¨_è¾ƒæ…¢çš„_æƒ…å†µä¸‹ï¼Œäº‹åŠ¡æŒç»­æ—¶é—´è¦é•¿10å€ã€‚è¿™ä¹Ÿç«‹å³å°†æ¯ç§’æœ€å¤§äº‹åŠ¡æ•°å‡å°‘äº†10å€ï¼ˆçº¿ç¨‹æ± æœ‰é™ï¼ŒCPUèµ„æºæœ‰é™ï¼‰ã€‚åœ¨ _æ›´å¤šå†…å­˜çš„_æƒ…å†µä¸‹ï¼Œæ¯ä¸ªäº‹åŠ¡ä½¿ç”¨10å€çš„å†…å­˜ã€‚è¿™ç›´æ¥å°†åƒåœ¾æ”¶é›†çš„æ•°é‡æé«˜åˆ°æ¯ç§’è¶…è¿‡ä¸€ä¸ªï¼Œä»è€Œå¯¼è‡´ä¸å¯å¿½ç•¥çš„å¼€é”€ã€‚ä½¿ç”¨æ›´å¤šçš„å†…å­˜ï¼Œä¾‹å¦‚åœ¨åœºæ™¯ _å¤šä½™çš„å†…å­˜ä¸­_è¿™å°†å¯¼è‡´æ¯ç§’15æ¬¡æ”¶é›†ï¼Œè€Œæ¯ä¸ªæ”¶é›†åªå‰©ä¸‹66msï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¤Ÿçš„ã€‚ç³»ç»Ÿå°†å´©æºƒã€‚åŒæ ·ï¼Œ66msä½äº100msçš„äº‹åŠ¡æŒç»­æ—¶é—´ï¼Œå› æ­¤è®¸å¤šæ­£åœ¨è¿è¡Œçš„äº‹åŠ¡ä»å°†ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œä»è€Œé˜»æ­¢äº†å®ƒçš„æ”¶é›†ï¼Œå¹¶å¯¼è‡´è¯¥å†…å­˜ä¼ æ’­ç»™è¾ƒæ—©çš„ä¸€ä»£ã€‚è¿™æ„å‘³ç€è¾ƒæ—©çš„å‡ ä»£äººå°†å¼€å§‹æˆé•¿ï¼Œå¹¶ä¸”éœ€è¦è¾ƒæ—©çš„å¤§é‡ï¼ˆæ…¢é€Ÿï¼‰æ”¶è—ã€‚è¯¥æ–¹æ¡ˆä¸­çš„åº”ç”¨ç¨‹åºå°†ä¸å†æ‰§è¡Œã€‚æˆ‘è®¤ä¸ºï¼Œä¸ä»…æ…¢é€Ÿä»£ç ç›¸æ¯”ï¼Œè¿™æ¸…æ¥šåœ°è¡¨æ˜äº†è¿‡å¤šçš„å†…å­˜æ¶ˆè€—æ˜¯å¤šä¹ˆç³Ÿç³•ã€‚å½“æ‚¨åˆ†é…è¿‡å¤šçš„å†…å­˜æ—¶ï¼Œæ‰€æœ‰è¶…å¿«é€Ÿä»£ç éƒ½æ— æ³•ä¸ºæ‚¨æä¾›å¸®åŠ©ã€‚

*   [å­—ç¬¦ä¸²ä¸²è”](#0)
*   [å¤±å»StringBufferæ€§èƒ½](#1)
*   [æµ‹è¯•å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰](#2)
*   [å°†æ•°å­—è½¬æ¢ä¸ºå­—ç¬¦ä¸²](#3)
*   [è§£æå’Œè½¬æ¢æ•°å­—](#4)
*   [ä¸åˆ©ç”¨ä¸å¯å˜å¯¹è±¡](#5)
*   [XMLè§£æå™¨ç”¨äºsissies](#6)
*   [ç”¨Stringæ“ä½œç»„è£…XML](#7)
*   [XMLç¼–ç é™·é˜±](#8)
*   [å­—ç¬¦ä¸æ˜¯æ•´æ•°](#9)
*   [å‡è®¾charä»£è¡¨ä¸€ä¸ªå­—ç¬¦](#10)
*   [å¹³å°ç›¸å…³çš„æ–‡ä»¶å](#11)
*   [æœªå®šä¹‰çš„ç¼–ç ](#12)
*   [æ— ç¼“å†²æµ](#13)
*   [InputStreamReaderï¼ŒOutputStreamWriterä¸Šçš„æœªç¼“å†²æ“ä½œ](#14)
*   [ä½¿ç”¨PrintWriterè¿›è¡Œæ–‡ä»¶I / O](#15)
*   [æ— é™å †](#16)
*   [æ— é™æ—¶é—´](#17)
*   [å‡è®¾ä¾¿å®œçš„è®¡æ—¶å™¨å‘¼å«](#18)
*   [æŠ“ä½ä¸€åˆ‡ï¼šæˆ‘ä¸çŸ¥é“æ­£ç¡®çš„è¿è¡Œæ—¶å¼‚å¸¸](#19)
*   [å¼‚å¸¸å¾ˆçƒ¦äºº](#20)
*   [é‡æ–°åŒ…è£…RuntimeException](#21)
*   [æ²¡æœ‰æ­£ç¡®ä¼ æ’­å¼‚å¸¸](#22)
*   [æ„šè ¢çš„å¼‚å¸¸æ¶ˆæ¯](#23)
*   [æ•æ‰æ—¥å¿—](#24)
*   [ä¸å®Œæ•´çš„å¼‚å¸¸å¤„ç†](#25)
*   [æ°¸è¿œä¸ä¼šå‘ç”Ÿçš„ä¾‹å¤–](#26)
*   [ç¬æ€é™·é˜±](#27)
*   [è¿‡åº¦æ€ä¼¤åˆå§‹åŒ–](#28)
*   [æ—¥å¿—å®ä¾‹ï¼šé™æ€è¿˜æ˜¯éé™æ€ï¼Ÿ](#29)
*   [é€‰æ‹©é”™è¯¯çš„ç±»åŠ è½½å™¨](#30)
*   [ä½¿ç”¨åå°„ä¸è‰¯](#31)
*   [åŒæ­¥è¿‡åº¦æ€ä¼¤åŠ›](#32)
*   [åˆ—è¡¨ç±»å‹é”™è¯¯](#33)
*   [HashMapå¤§å°é™·é˜±](#34)
*   [Hashtableï¼ŒHashMapå’ŒHashSetè¢«é«˜ä¼°äº†](#35)
*   [æ¸…å•è¢«é«˜ä¼°](#36)
*   [å¯¹è±¡æ•°ç»„éå¸¸çµæ´»](#37)
*   [ç‰©ä½“è¿‡æ—©åˆ†è§£](#38)
*   [ä¿®æ”¹äºŒä¼ æ‰‹](#39)
*   [ä¸å¿…è¦çš„æ—¥å†](#40)
*   [ä¾èµ–é»˜è®¤çš„æ—¶åŒº](#41)
*   [æ—¶åŒºâ€œè½¬æ¢â€](#42)
*   [ä½¿ç”¨Calendar.getInstanceï¼ˆï¼‰](#43)
*   [å±é™©æ—¥å†æ“ä½œ](#44)
*   [è°ƒç”¨Date.setTimeï¼ˆï¼‰](#45)
*   [å‡è®¾SimpleDateFormatæ˜¯çº¿ç¨‹å®‰å…¨çš„](#46)
*   [å…·æœ‰å…¨å±€Configuration / Parameters / Constantsç±»](#47)
*   [æ²¡æœ‰æ³¨æ„åˆ°æº¢å‡º](#48)
*   [å°†==ä¸floatæˆ–doubleä¸€èµ·ä½¿ç”¨](#49)
*   [å°†é’±å­˜å…¥æµ®ç‚¹å˜é‡](#50)
*   [åœ¨finallyå—ä¸­ä¸é‡Šæ”¾èµ„æº](#51)
*   [æ»¥ç”¨finalizeï¼ˆï¼‰](#52)
*   [ä¸ç”±è‡ªä¸»åœ°é‡ç½®Thread.interrupted](#53)
*   [æ¥è‡ªé™æ€åˆå§‹å€¼è®¾å®šé¡¹çš„ç”Ÿæˆçº¿ç¨‹](#54)
*   [å–æ¶ˆäº†ä¿æŒçŠ¶æ€çš„è®¡æ—¶å™¨ä»»åŠ¡](#55)
*   [æ‹¥æœ‰å¯¹ClassLoaderå’Œæ— æ³•åˆ·æ–°çš„ç¼“å­˜çš„å¼ºå¤§å¼•ç”¨](#56)
*   [åµŒå¥—åŒæ­¥è¯­å¥](#57)
*   [é€šè¿‡RandomAccessFileè¿›è¡Œéšæœºæ–‡ä»¶è®¿é—®](#58)

### å­—ç¬¦ä¸²ä¸²è”
```
String s = "";
for (Person p : persons) {
    s += ", " + p.getName();
}
s = s.substring(2); //remove first comma
```
è¿™æ˜¯çœŸæ­£çš„å†…å­˜æµªè´¹ã€‚å¾ªç¯ä¸­å­—ç¬¦ä¸²çš„é‡å¤è¿æ¥ä¼šå¯¼è‡´å¤§é‡åƒåœ¾å’Œæ•°ç»„å¤åˆ¶ã€‚è€Œä¸”ï¼Œå¿…é¡»å°†ç”Ÿæˆçš„å­—ç¬¦ä¸²å›ºå®šä¸ºå¤šä½™çš„é€—å·ï¼Œè¿™å¾ˆä¸‘é™‹ã€‚ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œ2016å¹´ä»ç„¶æœ‰äººç›¸ä¿¡ç¼–è¯‘å™¨ä¼šä»¥æŸç§æ–¹å¼å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚Java 8ä¸­ç”šè‡³æ²¡æœ‰ï¼ä¸€äº›ç™½ç—´ç”šè‡³ä»¥æ‰§è¡Œæ—¶é—´ä¸ºåŸºå‡†ï¼Œä»¥â€œè¯æ˜â€è¿˜å¯ä»¥ã€‚ä¸ï¼Œäº§ç”Ÿå¤§é‡ä¸å¿…è¦çš„åƒåœ¾ä¸æ˜¯å¾ˆå¥½ã€‚å¦‚æœæ‚¨ä»ç„¶ä¸ç›¸ä¿¡æˆ‘ï¼Œé‚£ä¹ˆæˆ‘ä¹Ÿä¸èƒ½å¸®åŠ©æ‚¨çš„æ— çŸ¥ã€‚
```
StringBuilder sb = new StringBuilder(persons.size() \* 16); // well estimated buffer
for (Person p : persons) {
    if (sb.length() > 0) sb.append(", "); // the JIT optimizes the if away out of the loop (peeling)
    sb.append(p.getName);
}
```
### å¤±å»StringBufferæ€§èƒ½
```
StringBuffer sb = new StringBuffer();
sb.append("Name: ");
sb.append(name + '\\n');
sb.append("!");
...
String s = sb.toString();
```
è¿™çœ‹èµ·æ¥åƒä¼˜åŒ–çš„ä»£ç ï¼Œä½†è¿˜ä¸æ˜¯æœ€ä½³çš„ã€‚é‚£ä¹ˆï¼Œå¦‚æœæ‚¨æœªèƒ½æ­£ç¡®åœ°è¿›è¡Œä¼˜åŒ–ï¼Œä¸ºä»€ä¹ˆè¦é¦–å…ˆè¿›è¡Œä¼˜åŒ–å‘¢ï¼Ÿä¸€è·¯èµ°ï¼æœ€æ˜æ˜¾çš„é”™è¯¯æ˜¯ç¬¬3è¡Œä¸­çš„å­—ç¬¦ä¸²è¿æ¥ã€‚åœ¨ç¬¬4è¡Œä¸­ï¼Œæ·»åŠ a `char`æ¯”æ·»åŠ Stringå¿«ã€‚å¦å¤–ä¸€ä¸ªä¸»è¦çš„é—æ¼æ˜¯ç¼“å†²åŒºç¼ºå°‘é•¿åº¦åˆå§‹åŒ–ï¼Œè¿™å¯èƒ½å¯¼è‡´ä¸å¿…è¦çš„è°ƒæ•´å¤§å°ï¼ˆæ•°ç»„å¤åˆ¶ï¼‰ã€‚åœ¨JDK 1.5åŠæ›´é«˜ç‰ˆæœ¬ä¸­ `StringBuilder`ï¼Œ`StringBuffer`åº”è¯¥ä½¿ç”¨è€Œä¸æ˜¯ï¼šå› ä¸ºå®ƒåªæ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œæ‰€ä»¥éšå¼åŒæ­¥æ˜¯å¤šä½™çš„ã€‚å®é™…ä¸Šï¼Œä½¿ç”¨ç®€å•çš„Stringä¸²è”å¯ä»¥ç¼–è¯‘æˆå‡ ä¹å®Œç¾çš„å­—èŠ‚ç ï¼šä»…ç¼ºå°‘é•¿åº¦åˆå§‹åŒ–ã€‚
```
StringBuilder sb = new StringBuilder(100);
sb.append("Name: ");
sb.append(name);
sb.append("\\n!");
String s = sb.toString();

String s = "Name: " + name + "\\n!";
```
### æµ‹è¯•å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰
```
if (name.compareTo("John") == 0) ...
if (name == "John") ...
if (name.equals("John")) ...
if ("".equals(name)) ...
```
ä»¥ä¸Šæ¯”è¾ƒå‡æ— è¯¯-ä½†å®ƒä»¬ä¹Ÿä¸æ˜¯å¾ˆå¥½ã€‚è¯¥`compareTo`æ–¹æ³•è¿‡å¤§ä¸”è¿‡äºå†—é•¿ã€‚åœ¨`==`ä¸ºå¯¹è±¡çš„èº«ä»½è¿è¥å•†çš„æµ‹è¯•ï¼Œå¯èƒ½ä¸æ˜¯ä½ æƒ³è¦çš„ã€‚è¯¥`equals`æ–¹æ³•æ˜¯å¯è¡Œçš„æ–¹æ³•ï¼Œä½†æ˜¯å¦‚æœ`name`æ˜¯ï¼Œåˆ™åè½¬å¸¸é‡å’Œå˜é‡å°†ä¸ºæ‚¨æä¾›é¢å¤–çš„å®‰å…¨æ€§`null`ã€‚
```
if ("John".equals(name)) ...
if (name.length() == 0) ...
if (name.isEmpty()) ...
```
### å°†æ•°å­—è½¬æ¢ä¸ºå­—ç¬¦ä¸²
```
"" + set.size()
new Integer(set.size()).toString() 
```
æ–¹æ³•çš„è¿”å›ç±»å‹`Set.size()`ä¸º`int`ã€‚éœ€è¦è½¬æ¢ä¸º`String`ã€‚å®é™…ä¸Šï¼Œè¿™ä¸¤ä¸ªç¤ºä¾‹å¯ä»¥è¿›è¡Œè½¬æ¢ã€‚ä½†æ˜¯ç¬¬ä¸€ç§æ–¹æ³•ä¼šå¯¼è‡´ä¸²è”æ“ä½œçš„ä»£ä»·ï¼ˆè½¬æ¢ä¸º`(new StringBuilder()).append(i).toString())`ï¼‰ã€‚ç¬¬äºŒä¸ªåˆ›å»ºä¸­é—´çš„IntegeråŒ…è£…å™¨ã€‚æ­£ç¡®çš„æ–¹æ³•æ˜¯å…¶ä¸­ä¹‹ä¸€
```
Integer.toString(set.size())
```
### è§£æå’Œè½¬æ¢æ•°å­—
```
int v = Integer.valueOf(str).intValue();
int w = Long.valueOf(Double.valueOf(str).longValue).intValue();
```
äº†è§£å¦‚ä½•ä½¿ç”¨APIâ€‹â€‹è€Œä¸åˆ†é…ä¸å¿…è¦çš„å¯¹è±¡ã€‚
```
int v = Integer.parseInt(str);
int w = (int) Double.parseDouble(str);
```
### ä¸åˆ©ç”¨ä¸å¯å˜å¯¹è±¡
```
zero = new Integer(0);
return Boolean.valueOf("true");
```
`Integer`ä»¥åŠ`Boolean`æ˜¯ä¸å¯æ”¹å˜çš„ã€‚å› æ­¤ï¼Œåˆ›å»ºä»£è¡¨ç›¸åŒå€¼çš„å¤šä¸ªå¯¹è±¡æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚è¿™äº›ç±»å…·æœ‰é’ˆå¯¹å¸¸ç”¨å®ä¾‹çš„å†…ç½®ç¼“å­˜ã€‚å¯¹äºå¸ƒå°”å‹ï¼Œç”šè‡³åªæœ‰ä¸¤ä¸ªå¯èƒ½çš„å®ä¾‹ã€‚ç¨‹åºå‘˜å¯ä»¥åˆ©ç”¨ä»¥ä¸‹ä¼˜åŠ¿ï¼š
```
zero = Integer.valueOf(0);
return Boolean.TRUE;
```
### XMLè§£æå™¨ç”¨äºsissies
```
int start = xml.indexOf("<name>") + "<name>".length();
int end = xml.indexOf("</name>");
String name = xml.substring(start, end);
```
è¿™ç§å¹¼ç¨šçš„XMLè§£æä»…é€‚ç”¨äºæœ€ç®€å•çš„XMLæ–‡æ¡£ã€‚ä½†æ˜¯ï¼Œå¦‚æœaï¼‰nameå…ƒç´ åœ¨æ–‡æ¡£ä¸­ä¸æ˜¯å”¯ä¸€çš„ï¼Œbï¼‰nameçš„å†…å®¹ä¸ä»…æ˜¯å­—ç¬¦æ•°æ®cï¼‰nameçš„æ–‡æœ¬æ•°æ®åŒ…å«è½¬ä¹‰å­—ç¬¦dï¼‰å°†è¯¥æ–‡æœ¬æ•°æ®æŒ‡å®šä¸ºCDATAéƒ¨åˆ†eï¼Œå®ƒå°†å¤±è´¥ã€‚ ï¼‰æ–‡æ¡£ä½¿ç”¨XMLåç§°ç©ºé—´ã€‚XMLå¯¹äºå­—ç¬¦ä¸²æ“ä½œæ¥è¯´å¤ªå¤æ‚äº†ã€‚è¯¸å¦‚Xercesä¹‹ç±»çš„XMLè§£æå™¨æ˜¯ä¸€ä¸ªè¶…è¿‡ä¸€å…†å­—èŠ‚çš„jaræ–‡ä»¶ï¼Œè¿™æ˜¯æœ‰åŸå› çš„ï¼ä¸JDOMç­‰æ•ˆçš„æ˜¯ï¼š
```
SAXBuilder builder = new SAXBuilder(false);
Document doc = doc = builder.build(new StringReader(xml));
String name = doc.getRootElement().getChild("name").getText();
```
### ç”¨Stringæ“ä½œç»„è£…XML
```
String name = ...
String attribute = ...
String xml = "<root>"
            +"<name att=\\""+ attribute +"\\">"+ name +"</name>"
            +"</root>";
```
è®¸å¤šåˆå­¦è€…å¾ˆæƒ³é€šè¿‡ä½¿ç”¨Stringæ“ä½œï¼ˆä»–ä»¬éå¸¸äº†è§£è€Œä¸”å¾ˆå®¹æ˜“ï¼‰æ¥äº§ç”Ÿå¦‚ä¸Šæ‰€ç¤ºçš„XMLè¾“å‡ºã€‚ç¡®å®ï¼Œè¿™æ˜¯éå¸¸ç®€å•ä¸”å‡ ä¹ç²¾ç¾çš„ä»£ç ã€‚ä½†æ˜¯ï¼Œå®ƒæœ‰ä¸€ä¸ªä¸¥é‡çš„ç¼ºç‚¹ï¼šå®ƒæ— æ³•è½¬ä¹‰ä¿ç•™çš„å­—ç¬¦ã€‚å› æ­¤ï¼Œå¦‚æœå˜é‡åç§°æˆ–å±æ€§åŒ…å«ä»»ä½•ä¿ç•™å­—ç¬¦<ï¼Œ>ï¼Œï¼†ï¼Œâ€œæˆ–â€ï¼Œåˆ™æ­¤ä»£ç å°†ç”Ÿæˆæ— æ•ˆçš„XMLã€‚æ­¤å¤–ï¼Œä¸€æ—¦XMLä½¿ç”¨åç§°ç©ºé—´ï¼Œå­—ç¬¦ä¸²æ“ä½œå¯èƒ½å¾ˆå¿«å°±ä¼šå˜å¾—è®¨åŒå¹¶ä¸”éš¾ä»¥ç»´æŠ¤ã€‚ XMLåº”è¯¥åœ¨DOMä¸­ç»„è£…ï¼ŒJDomåº“å¯¹æ­¤éå¸¸æœ‰ç”¨ã€‚
```
Element root = new Element("root");
root.setAttribute("att", attribute);
root.setText(name);
Document doc = new Documet();
doc.setRootElement(root);
XmlOutputter out = new XmlOutputter(Format.getPrettyFormat());
String xml = out.outputString(root);
```
### XMLç¼–ç é™·é˜±
```
String xml = FileUtils.readTextFile("my.xml");
```
è¯»å–XMLæ–‡ä»¶å¹¶å°†å…¶å­˜å‚¨åœ¨Stringä¸­æ˜¯ä¸€ä¸ªéå¸¸ç³Ÿç³•çš„ä¸»æ„ã€‚XMLåœ¨XMLæ ‡å¤´ä¸­æŒ‡å®šå…¶ç¼–ç ã€‚ä½†æ˜¯åœ¨è¯»å–æ–‡ä»¶æ—¶ï¼Œæ‚¨å¿…é¡»äº‹å…ˆçŸ¥é“ç¼–ç ï¼å¦å¤–ï¼Œå°†XMLæ–‡ä»¶å­˜å‚¨åœ¨å­—ç¬¦ä¸²ä¸­ä¼šæµªè´¹å†…å­˜ã€‚æ‰€æœ‰XMLè§£æå™¨éƒ½æ¥å—InputStreamä½œä¸ºè§£ææºï¼Œå¹¶ä¸”å®ƒä»¬è‡ªå·±ä¼šæ­£ç¡®è®¡ç®—å‡ºç¼–ç ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥å‘ä»–ä»¬æä¾›InputStreamè€Œä¸æ˜¯å°†æ•´ä¸ªæ–‡ä»¶ä¸´æ—¶å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚å½“ä½¿ç”¨å¤šå­—èŠ‚ç¼–ç ï¼ˆä¾‹å¦‚UTF-8ï¼‰æ—¶ï¼Œå­—èŠ‚é¡ºåºï¼ˆå¤§ç«¯ï¼Œå°ç«¯ï¼‰æ˜¯å¦ä¸€ä¸ªé™·é˜±ã€‚XMLæ–‡ä»¶å¯èƒ½åœ¨å¼€å¤´æŒ‡å®šäº†å­—èŠ‚é¡ºåºçš„å­—èŠ‚é¡ºåºæ ‡è®°ã€‚XMLè§£æå™¨å¯ä»¥æ­£ç¡®å¤„ç†å®ƒä»¬ã€‚

### å­—ç¬¦ä¸æ˜¯æ•´æ•°
```
int i = in.read();
char c = (char) i;
```
ä¸Šé¢çš„ä»£ç å‡å®šæ‚¨å¯ä»¥ä»æ•°å­—åˆ›å»ºå­—ç¬¦ã€‚ä»æŠ€æœ¯ä¸Šè®²ï¼Œè¿™å·²ç»æ˜¯é”™è¯¯çš„ï¼šintæ˜¯æœ‰ç¬¦å·çš„ï¼Œè€Œcharæ˜¯æ— ç¬¦å·çš„ã€‚å­—ç¬¦åªæ˜¯16ä½UTF-16ç¼–ç çš„Unicodeã€‚è¯·æ³¨æ„ï¼ŒUnicodeå®šä¹‰çš„ä»£ç ç‚¹æ•°é‡è¶…å‡ºäº†16ä½æ‰€èƒ½å®¹çº³çš„èŒƒå›´ï¼ˆUnicode 9.0çš„ç¼–ç ç‚¹ä¸º271792ä¸ªï¼Œè€Œ65536ä¸ª16ä½æ•°å­—ï¼‰ã€‚è¯¸å¦‚æµè¡Œè¡¨æƒ…ç¬¦å·ä¹‹ç±»çš„ä»£ç ç‚¹å·²ç»è¿œè¿œè¶…å‡ºäº†[BMP](https://en.wikipedia.org/wiki/Plane_(Unicode)#Basic_Multilingual_Plane)ï¼Œç”šè‡³åœ¨Javaä¸­ä¹Ÿç”±å¤šä¸ªcharè¡¨ç¤ºï¼æ— è®ºå¦‚ä½•ï¼Œåœ¨Javaä¸­ï¼Œè¯·ä½¿ç”¨Reader / Writeræˆ–CharsetEncoder / CharsetDecoderåœ¨å­—ç¬¦åŠå…¶å­—èŠ‚è¡¨ç¤ºå½¢å¼ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼ˆè¯·å‚è§ä¸‹æ–‡ï¼‰ã€‚

### å‡è®¾charä»£è¡¨ä¸€ä¸ªå­—ç¬¦
```
"\\uD83D\\uDC31".length() == 2
```
è½¬ä¹‰åºåˆ—å°† UTF-16ä¸­çš„Unicodeä»£ç ç‚¹[0x1F431](http://www.isthisthingon.org/unicode/index.phtml?glyph=1F431)è¡¨ç¤ºä¸º2ä¸ªå­—ç¬¦ã€‚å› æ­¤ï¼Œå³ä½¿è¿™åªæ˜¯å±å¹•ï¼ˆğŸ±ï¼‰ä¸Šçš„å•ä¸ªçŒ«è„¸ç¬¦å·ï¼Œlengthï¼ˆï¼‰æ–¹æ³•ä»è¿”å›2ã€‚

### å¹³å°ç›¸å…³çš„æ–‡ä»¶å
```
File tmp = new File("C:\\\\Temp\\\\1.tmp");
File exp = new File("export-2013-02-01T12:30.txt");
File f = new File(path +'/'+ filename);
```
ç»å¯¹ä¸è¦åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨ç¡¬ç¼–ç è·¯å¾„ã€‚ä¸åŒçš„å¹³å°å…·æœ‰ä¸åŒçš„çº¦å®šï¼Œå¹¶ä¸”æ‚¨æ°¸è¿œä¸èƒ½ç¡®å®šåœ¨éšæœºç³»ç»Ÿä¸Šå®é™…æ˜¯å¦å¯ä»¥ä½¿ç”¨ç¡¬ç¼–ç è·¯å¾„ã€‚ä½¿ç”¨APIâ€‹â€‹è°ƒç”¨æ¥åˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚è¯·æ³¨æ„ï¼Œä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿå¯¹äº§ç”Ÿæœ‰æ•ˆæ–‡ä»¶åçš„é™åˆ¶ä¸åŒã€‚è¿™é‡Œçš„expæ–‡ä»¶åŒ…å«ä¸€ä¸ªå†’å·ï¼Œåœ¨Windowsæ–‡ä»¶ç³»ç»Ÿä¸Šæ˜¯éæ³•çš„ã€‚åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­æ„é€ ç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„æ—¶ï¼Œè¯·æ³¨æ„ä¾èµ–äºå¹³å°çš„åˆ†éš”ç¬¦ã€‚
```
File tmp = File.createTempFile("myapp","tmp");
File exp = new File("export-2013-02-01\_1230.txt");

File f = new File(path + File.separatorChar + filename);
// or even better
File dir = new File(path);
File f = new File(dir, filename);
```
### æœªå®šä¹‰çš„ç¼–ç 
```
Reader r = new FileReader(file);
Writer w = new FileWriter(file);
Reader r = new InputStreamReader(inputStream);
Writer w = new OutputStreamWriter(outputStream);
String s = new String(byteArray); // byteArray is a byte\[\]
byte\[\] a = string.getBytes();
```
ä»¥ä¸Šå„è¡Œåœ¨é»˜è®¤å¹³å°ç¼–ç ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼Œ`byte`å¹¶`char`ä½¿ç”¨é»˜è®¤å¹³å°ç¼–ç ã€‚è¯¥ä»£ç çš„è¡Œä¸ºæ ¹æ®å…¶æ‰€è¿è¡Œçš„å¹³å°è€Œæœ‰æ‰€ä¸åŒã€‚å¦‚æœæ•°æ®ä»ä¸€ä¸ªå¹³å°æµåˆ°å¦ä¸€ä¸ªå¹³å°ï¼Œè¿™å°†æ˜¯æœ‰å®³çš„ã€‚å®Œå…¨ä¾é é»˜è®¤å¹³å°ç¼–ç è¢«è®¤ä¸ºæ˜¯ä¸å¥½çš„åšæ³•ã€‚è½¬æ¢åº”å§‹ç»ˆä»¥å®šä¹‰çš„ç¼–ç æ‰§è¡Œã€‚
```
Reader r = new InputStreamReader(new FileInputStream(file), "ISO-8859-1");
Writer w = new OutputStreamWriter(new FileOutputStream(file), "ISO-8859-1");
Reader r = new InputStreamReader(inputStream, StandardCharsets.UTF\_8);
Writer w = new OutputStreamWriter(outputStream, StandardCharsets.UTF\_8);
String s = new String(byteArray, "ASCII");
byte\[\] a = string.getBytes("ASCII");
```
### æ— ç¼“å†²æµ
```
InputStream in = new FileInputStream(file);
int b;
while ((b = in.read()) != -1) {
   ...
}
```
ä¸Šé¢çš„ä»£ç é€å­—èŠ‚è¯»å–æ–‡ä»¶ã€‚`read()`æµä¸Šçš„æ¯ä¸ªè°ƒç”¨éƒ½ä¼šå¯¼è‡´å¯¹æ–‡ä»¶ç³»ç»Ÿçš„æœ¬æœºå®ç°çš„æœ¬æœºï¼ˆJNIï¼‰è°ƒç”¨ã€‚æ ¹æ®å®ç°çš„ä¸åŒï¼Œè¿™å¯èƒ½å¯¼è‡´å¯¹æ“ä½œç³»ç»Ÿçš„ç³»ç»Ÿè°ƒç”¨ã€‚JNIè°ƒç”¨æ˜‚è´µï¼Œè€Œsyscallä¹Ÿæ˜¯å¦‚æ­¤ã€‚é€šè¿‡å°†æµåŒ…è£…åˆ°ä¸­ï¼Œå¯ä»¥å¤§å¤§å‡å°‘æœ¬åœ°è°ƒç”¨çš„æ¬¡æ•°`BufferedInputStream`ã€‚`/dev/zero`ä½¿ç”¨ä¸Šè¿°ä»£ç ä»ä¸­è¯»å–1 MBçš„æ•°æ®åœ¨ç¬”è®°æœ¬ç”µè„‘ä¸ŠèŠ±è´¹äº†å¤§çº¦1ç§’é’Ÿã€‚ä½¿ç”¨ä¸‹é¢çš„å›ºå®šä»£ç ï¼Œå®ƒå¯ä»¥å‡å°‘åˆ°60æ¯«ç§’ï¼è¿™æ ·å¯ä»¥èŠ‚çœ94ï¼…ã€‚å½“ç„¶ï¼Œè¿™ä¹Ÿé€‚ç”¨äºè¾“å‡ºæµã€‚è¿™ä¸ä»…é€‚ç”¨äºæ–‡ä»¶ç³»ç»Ÿï¼Œè€Œä¸”é€‚ç”¨äºå¥—æ¥å­—ã€‚
```
InputStream in = new BufferedInputStream(new FileInputStream(file));

### InputStreamReaderï¼ŒOutputStreamWriterä¸Šçš„æœªç¼“å†²æ“ä½œ

Writer w = new OutputStreamWriter(os, StandardCharsets.UTF\_8);
while (...) {
  // many small (<8kB) writes
  w.write("something");
}

Reader r = new InputStreamReader(in,  StandardCharsets.UTF\_8);
while (...) {
  // not reading into a buffer (char\[\], etc.)
  int c = r.read();
}
```
å¦‚å›¾[æ‰€ç¤ºï¼Œ](/weblog/posting.php?posting=671)å› ä¸ºä»charåˆ°å­—èŠ‚çš„è½¬æ¢å¹¶ä¸å®¹æ˜“ï¼Œæ‰€ä»¥OutputStreamWriteræ¯æ¬¡è°ƒç”¨writeï¼ˆï¼‰æ–¹æ³•éƒ½ä¼šä½¿ç”¨å†…å­˜ã€‚å§‹ç»ˆç¼“å†²é‚£äº›å†™æ“ä½œï¼š
```
Writer w = new BufferedWriter(new OutputStreamWriter(os, StandardCharsets.UTF\_8));
Reader r = new BufferedReader(new InputStreamReader(in, StandardCharsets.UTF\_8));
```
ä¸ºäº†è¯»å†™æ–‡æœ¬æ–‡ä»¶ï¼Œæ­£ç¡®çš„æµé“¾å˜ä¸ºï¼š
```
Writer w = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(f), StandardCharsets.UTF\_8));
Reader r = new BufferedReader(new InputStreamReader(new FileInputStream(f), StandardCharsets.UTF\_8));
```
### ä½¿ç”¨PrintWriterè¿›è¡Œæ–‡ä»¶I / O
```
PrintWriter w = new PrintWriter(new File("out.txt"), "UTF-8");
w.println("hello world");
```
PrintWriterä»ä¸æŠ›å‡ºIOExceptionã€‚å³ä½¿ç£ç›˜å·²æ»¡ã€‚å³ä½¿åœ¨ç£ç›˜å·²æ»¡åç»§ç»­è°ƒç”¨printlnï¼ˆï¼‰ä¸€ç™¾ä¸‡æ¬¡ã€‚å³ä½¿åœ¨æ‚¨æ‰“ç”µè¯æ—¶ä¹Ÿæ²¡æœ‰`close()`ã€‚æ‚¨éœ€è¦æ˜¾å¼è°ƒç”¨ `checkError()`ä»¥æµ‹è¯•é—®é¢˜ã€‚ç„¶åæ‚¨ä»ç„¶æ²¡æœ‰å¾—åˆ°ä¸€ä¸ªå¼‚å¸¸ï¼Œè¯¥å¼‚å¸¸å¯ä»¥å‘Šè¯‰æ‚¨åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚æ‚¨å¾—åˆ°çš„åªæ˜¯ä¸€ä¸ªå¸ƒå°”å‹è¯´æ³•ï¼Œå³åœ¨å†™å…¥è¿‡ç¨‹ä¸­çš„æŸä¸ªæ—¶åˆ»å‡ºç°é—®é¢˜ï¼Œ _æ–‡ä»¶ç°åœ¨å·²æŸå_ã€‚é—®é¢˜å°±åœ¨è¿™é‡Œã€‚é™é»˜çš„æ–‡ä»¶æŸåä¸æ˜¯ä»»ä½•äººæƒ³è¦çš„ã€‚è¦ä¹ˆç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„æ–‡ä»¶ï¼Œè¦ä¹ˆæ ¹æœ¬ä¸ç”Ÿæˆä»»ä½•æ–‡ä»¶ï¼Œç„¶åå‡ºé”™ã€‚PrintWriteræ˜¯ä¸ºç½‘ç»œI / Oï¼ˆè€Œéæ–‡ä»¶I / Oï¼‰è€Œå‘æ˜çš„ã€‚ä¾‹å¦‚ï¼Œå®ƒç”±Servletä½¿ç”¨ã€‚å¦ä¸€ä¸ªä¸é”™çš„åº”ç”¨ç¨‹åºæ˜¯æ—¥å¿—è®°å½•ï¼Œå½“æ‚¨çœŸçš„ä¸åœ¨ä¹æ—¥å¿—è®°å½•æ˜¯å¦äº§ç”ŸI / Oé”™è¯¯æ—¶ã€‚ä¾‹å¦‚ï¼Œå®ƒåœ¨JDBC APIä¸­ä½¿ç”¨ã€‚å¦‚ä½•é¿å…å†™å…¥æŸåçš„æ–‡ä»¶ï¼š
```
File f = new File("out.txt");
Writer w = null;
try {
  w = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(f), StandardCharsets.UTF\_8));
  w.append("hello world"); 
  ...
  w.close();
  w = null;
} finally {
  if (w != null) {
    // there was an exception and f is corrupt
    try { w.close(); } catch (IOException e) { }
    f.delete();
  }
}
```
### æ— é™å †
```
byte\[\] pdf = toPdf(file);
```
åœ¨è¿™é‡Œï¼Œä¸€ç§æ–¹æ³•ä»æŸäº›è¾“å…¥åˆ›å»ºPDFæ–‡ä»¶ï¼Œç„¶åå°†äºŒè¿›åˆ¶PDFæ•°æ®ä½œä¸ºå­—èŠ‚æ•°ç»„è¿”å›ã€‚æ­¤ä»£ç å‡å®šç”Ÿæˆçš„æ–‡ä»¶è¶³å¤Ÿå°ä»¥é€‚åˆå¯ç”¨çš„å †å†…å­˜ã€‚å¦‚æœæ­¤ä»£ç ä¸èƒ½100ï¼…ç¡®å®šï¼Œåˆ™å¾ˆå®¹æ˜“å‡ºç°å†…å­˜ä¸è¶³çš„æƒ…å†µã€‚ç‰¹åˆ«æ˜¯å¦‚æœæ­¤ä»£ç åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œï¼Œé€šå¸¸æ„å‘³ç€è®¸å¤šå¹¶è¡Œçº¿ç¨‹ã€‚æ‰¹é‡æ•°æ®ç»ä¸èƒ½ä½¿ç”¨å­—èŠ‚æ•°ç»„è¿›è¡Œå¤„ç†ã€‚åº”è¯¥ä½¿ç”¨æµï¼Œå¹¶ä¸”åº”è¯¥å°†æ•°æ®å‡è„±æœºåˆ°ç£ç›˜æˆ–æ•°æ®åº“ä¸­ã€‚
```
File pdf = toPdf(file);
```
ä¸€ç§ç±»ä¼¼çš„åæ¨¡å¼æ˜¯ç¼“å†²æ¥è‡ªâ€œä¸å—ä¿¡ä»»â€ï¼ˆå®‰å…¨æœ¯è¯­ï¼‰æºçš„æµè¾“å…¥ã€‚ä¾‹å¦‚ç¼“å†²åˆ°è¾¾ç½‘ç»œå¥—æ¥å­—çš„æ•°æ®ã€‚å¦‚æœåº”ç”¨ç¨‹åºä¸çŸ¥é“å°†è¦åˆ°è¾¾å¤šå°‘æ•°æ®ï¼Œåˆ™å¿…é¡»ç¡®ä¿å®ƒå…³æ³¨æ•°æ®çš„å¤§å°ã€‚å¦‚æœç¼“å†²çš„æ•°æ®é‡è¶…è¿‡åˆç†çš„é™åˆ¶ï¼Œåˆ™åº”å‘è°ƒç”¨è€…å‘å‡ºé”™è¯¯æ¡ä»¶ï¼ˆå¼‚å¸¸ï¼‰çš„ä¿¡å·ï¼Œè€Œä¸æ˜¯é€šè¿‡ä½¿åº”ç”¨ç¨‹åºè¿›å…¥å†…å­˜ä¸è¶³çš„æƒ…å†µæ¥é©±åŠ¨åº”ç”¨ç¨‹åºã€‚

### æ— é™æ—¶é—´
```
Socket socket = ...
socket.connect(remote);
InputStream in = socket.getInputStream();
int i = in.read();
```
ä¸Šé¢çš„ä»£ç æœ‰ä¸¤ä¸ªä½¿ç”¨æœªæŒ‡å®šè¶…æ—¶çš„é˜»å¡è°ƒç”¨ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœè¶…æ—¶æ˜¯æ— é™çš„ã€‚è¿™å¯èƒ½å¯¼è‡´åº”ç”¨ç¨‹åºæ°¸ä¹…æŒ‚èµ·ã€‚é€šå¸¸ï¼Œé¦–å…ˆè®¾ç½®æ— é™è¶…æ—¶æ˜¯ä¸€ä¸ªéå¸¸æ„šè ¢çš„æƒ³æ³•ã€‚æ— é™é•¿ã€‚å³ä½¿åˆ°å¤ªé˜³å˜æˆçº¢è‰²å·¨äººï¼ˆçˆ†ç‚¸ï¼‰æ—¶ï¼Œå®ƒä»ç„¶æ˜¯é€šå¾€æ— é™çš„ä¸€ç§è½»æ¾æ–¹å¼ã€‚ä¸€èˆ¬çš„ç¨‹åºå‘˜å»ä¸–ï¼Œäº«å¹´72æˆ‘ä»¬æ ¹æœ¬**æ²¡æœ‰**åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œæˆ‘ä»¬è¦ç­‰å¾…é‚£ä¹ˆé•¿æ—¶é—´ã€‚æ— é™è¶…æ—¶åªæ˜¯è’è°¬çš„äº‹æƒ…ã€‚ä½¿ç”¨å°æ—¶ï¼Œå¤©ï¼Œå‘¨ï¼Œæœˆï¼Œ1å¹´ï¼Œ10å¹´ã€‚ä½†ä¸æ˜¯æ— é™ã€‚è¦è¿æ¥åˆ°è¿œç¨‹è®¡ç®—æœºï¼Œæˆ‘ä¸ªäººå‘ç°æœ‰20ç§’çš„è¶…æ—¶æ—¶é—´ã€‚äººç±»ç”šè‡³æ²¡æœ‰æ‚£è€…è€å¿ƒï¼Œå› æ­¤ä¼šå–æ¶ˆæ‰‹æœ¯ã€‚å°½ç®¡å¯ä»¥å¯¹é‡‡ç”¨è¶…æ—¶å‚æ•°çš„connectï¼ˆï¼‰æ–¹æ³•è¿›è¡Œå¾ˆå¥½çš„è¦†ç›–ï¼Œä½†å¯¹äºreadï¼ˆï¼‰åˆ™æ²¡æœ‰è¿™ç§è¦æ±‚ã€‚ä½†æ˜¯æ‚¨å¯ä»¥åœ¨æ¯ä¸ªé˜»å¡è°ƒç”¨ä¹‹å‰ä¿®æ”¹Socketçš„å¥—æ¥å­—è¶…æ—¶ã€‚ï¼ˆä¸ä»…æ˜¯ä¸€æ¬¡ï¼æ‚¨å¯ä»¥ä¸ºä¸åŒçš„æƒ…å†µè®¾ç½®ä¸åŒçš„è¶…æ—¶ã€‚ï¼‰å¥—æ¥å­—å°†åœ¨è¯¥è¶…æ—¶ä¹‹åé˜»æ­¢è°ƒç”¨æ—¶å¼•å‘å¼‚å¸¸ã€‚é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡çš„æ¡†æ¶è¿˜åº”è¯¥æä¾›APIï¼Œä»¥æ§åˆ¶è¿™äº›è¶…æ—¶å¹¶ä½¿ç”¨åˆç†çš„é»˜è®¤å€¼ã€‚æ— é™æ˜¯ä¸æ˜æ™ºçš„-å¤ªç–¯ç‹‚äº†ï¼Œè®©æ‚¨å‘ç–¯ã€‚
```
Socket socket = ...
socket.connect(remote, 20000); // fail after 20s
InputStream in = socket.getInputStream();
socket.setSoTimeout(15000);
int i = in.read();
```
ä¸å¹¸çš„æ˜¯ï¼Œæ–‡ä»¶ç³»ç»ŸAPIï¼ˆFileInputStreamï¼ŒFileChannelï¼ŒFileDescriptorï¼ŒFileï¼‰æ— æ³•æä¾›è®¾ç½®æ–‡ä»¶æ“ä½œè¶…æ—¶çš„æ–¹æ³•ã€‚çœŸæ˜¯ä¸å¹¸ å› ä¸ºè¿™äº›æ˜¯Javaåº”ç”¨ç¨‹åºä¸­æœ€å¸¸è§çš„é˜»å¡è°ƒç”¨ï¼šå†™stdout / stderrå’Œä»stdinè¯»å–æ˜¯æ–‡ä»¶æ“ä½œï¼Œè€Œå†™æ—¥å¿—æ–‡ä»¶æ˜¯å¸¸è§çš„ã€‚æ ‡å‡†è¾“å…¥/è¾“å‡ºæµä¸Šçš„æ“ä½œç›´æ¥å–å†³äºJava VMä¹‹å¤–çš„å…¶ä»–è¿›ç¨‹ã€‚å¦‚æœä»–ä»¬å†³å®šæ°¸è¿œé˜»æ­¢ï¼Œé‚£ä¹ˆåœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­å°†å¯¹è¿™äº›æµè¿›è¡Œè¯»/å†™æ“ä½œã€‚ç£ç›˜I / Oæ˜¯ç³»ç»Ÿä¸Šæ‰€æœ‰è¿›ç¨‹ç«äº‰çš„æœ‰é™èµ„æºã€‚ä¸èƒ½ä¿è¯å¯¹æ–‡ä»¶çš„ç®€å•è¯»å†™æ˜¯å¿«é€Ÿçš„ã€‚å¯èƒ½ä¼šå¯¼è‡´æœªæŒ‡å®šçš„ç­‰å¾…æ—¶é—´ã€‚ä»Šå¤©ï¼Œè¿œç¨‹æ–‡ä»¶ç³»ç»Ÿä¹Ÿæ— å¤„ä¸åœ¨ã€‚ç£ç›˜å¯ä»¥ä½äºSAN / NASä¸Šï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç½‘ç»œå®‰è£…æ–‡ä»¶ç³»ç»Ÿï¼ˆNFSï¼ŒAFSï¼ŒCIFS / Sambaï¼‰ã€‚å› æ­¤ï¼Œæ–‡ä»¶ç³»ç»Ÿè°ƒç”¨å®é™…ä¸Šå¯èƒ½æ˜¯ç½‘ç»œè°ƒç”¨ï¼šå¤ªç³Ÿç³•äº†ï¼Œä»¥è‡³äºæˆ‘ä»¬åœ¨è¿™é‡Œæ²¡æœ‰ç½‘ç»œAPIçš„åŠŸèƒ½ï¼å› æ­¤ï¼Œå¦‚æœæ“ä½œç³»ç»Ÿç¡®å®šå†™å…¥è¶…æ—¶ä¸º60ç§’ï¼Œåˆ™æ‚¨å°†æ— æ³•æ‰§è¡Œã€‚ä¸èƒ½å‡å®šä»»ä½•ç£ç›˜/æ–‡ä»¶æ“ä½œæ˜¯å¿«é€Ÿçš„ï¼Œç”šè‡³æ˜¯è¿œç¨‹çš„ï¼Œéƒ½æ˜¯å¤±è´¥çš„ã€‚åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡å‡è®¾æ–‡ä»¶æ“ä½œéœ€è¦å‡ ç§’é’Ÿæ¥å¸®åŠ©ç”¨æˆ·ã€‚å› æ­¤ï¼Œæœ€å¥½é¿å…æˆ–å¼‚æ­¥å®Œæˆï¼ˆåœ¨åå°ï¼‰ã€‚è§£å†³æ­¤é—®é¢˜çš„æ–¹æ³•æ˜¯ï¼šé€‚å½“çš„ç¼“å†²å’Œæ’é˜Ÿ/å¼‚æ­¥å¤„ç†ã€‚ç”šè‡³æ˜¯è¿œç¨‹çš„ã€‚åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡å‡è®¾æ–‡ä»¶æ“ä½œéœ€è¦å‡ ç§’é’Ÿæ¥å¸®åŠ©ç”¨æˆ·ã€‚å› æ­¤ï¼Œæœ€å¥½é¿å…æˆ–å¼‚æ­¥å®Œæˆï¼ˆåœ¨åå°ï¼‰ã€‚è§£å†³æ­¤é—®é¢˜çš„æ–¹æ³•æ˜¯ï¼šé€‚å½“çš„ç¼“å†²å’Œæ’é˜Ÿ/å¼‚æ­¥å¤„ç†ã€‚ç”šè‡³æ˜¯è¿œç¨‹çš„ã€‚åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡å‡è®¾æ–‡ä»¶æ“ä½œéœ€è¦å‡ ç§’é’Ÿæ¥å¸®åŠ©ç”¨æˆ·ã€‚å› æ­¤ï¼Œæœ€å¥½é¿å…æˆ–å¼‚æ­¥å®Œæˆï¼ˆåœ¨åå°ï¼‰ã€‚è§£å†³æ­¤é—®é¢˜çš„æ–¹æ³•æ˜¯ï¼šé€‚å½“çš„ç¼“å†²å’Œæ’é˜Ÿ/å¼‚æ­¥å¤„ç†ã€‚

### å‡è®¾ä¾¿å®œçš„è®¡æ—¶å™¨å‘¼å«
```
for (...) {
  long t = System.currentTimeMillis();
  long t = System.nanoTime();
  Date d = new Date();
  Calendar c = new GregorianCalendar();
}
```
åˆ›å»ºæ–°çš„æ—¥æœŸæˆ–æ—¥å†ä¼šæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ä»¥è·å–å½“å‰æ—¶é—´ã€‚åœ¨Unix / Linuxä¸Šï¼Œè¿™æ˜¯ç³»ç»Ÿè°ƒç”¨`gettimeofday`ï¼Œè¢«è®¤ä¸ºâ€œéå¸¸ä¾¿å®œâ€ã€‚å¥½å§ï¼Œä»…æ¯”å…¶ä»–ç³»ç»Ÿè°ƒç”¨ä¾¿å®œï¼å› ä¸ºå®ƒé€šå¸¸ä¸éœ€è¦ä»ç”¨æˆ·ç©ºé—´åˆ‡æ¢åˆ°å†…æ ¸ç©ºé—´ï¼Œè€Œæ˜¯å®ç°ä¸ºå¯¹å†…å­˜æ˜ å°„é¡µé¢çš„è¯»å–ã€‚ä»åœ¨å‘¼å«`gettimeofday`ä¸æ­£å¸¸çš„ä»£ç æ‰§è¡Œç›¸æ¯”ï¼Œå®ƒæ˜¯æ˜‚è´µçš„ã€‚å‘¼å«çš„ç¡®åˆ‡ä»£ä»·åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºä½“ç³»ç»“æ„å’Œé…ç½®ï¼ˆç°ä»£x86ç³»ç»Ÿå…·æœ‰å¯ç”±OSä½¿ç”¨çš„ä¼—å¤šè®¡æ—¶å™¨ï¼šHPETï¼ŒTSCï¼ŒRTCï¼ŒACPIï¼Œæ—¶é’ŸèŠ¯ç‰‡ç­‰ï¼‰ã€‚åœ¨æˆ‘çš„Linux-2.6.37-rc7ç³»ç»Ÿä¸Šï¼Œè®¡æ—¶å™¨è°ƒç”¨ä¼¼ä¹ä¹Ÿåœ¨ç³»ç»Ÿä¸ŠåŒæ­¥ã€‚è¿™æ„å‘³ç€æ‰€æœ‰çº¿ç¨‹/è¿›ç¨‹å…±äº«æ¯æ¯«ç§’çº¦800ä¸ªè°ƒç”¨çš„æ€»å¯ç”¨å¸¦å®½ã€‚å› æ­¤ï¼Œæˆ‘çš„åŒæ ¸è¿è¡Œ2ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹æ¯æ¯«ç§’å¯ä»¥è¿›è¡Œçº¦400æ¬¡è°ƒç”¨ã€‚ï¼ˆæ„Ÿè°¢J. Daviesçš„æç¤ºï¼‰æœ€åä½†å¹¶éæœ€ä¸é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œæ­¤è®¡æ—¶å™¨çš„åˆ†è¾¨ç‡ä¸æ˜¯æ— é™çš„ã€‚å……å…¶é‡æœ€å¥½æ˜¯æ¯«ç§’ï¼Œä½†å®ƒå¯èƒ½æ˜¯25åˆ°50æ¯«ç§’å·¦å³çš„è¾ƒå¤§æŠ–åŠ¨ã€‚ç°ä»£Linuxç³»ç»Ÿå¯ä»¥åœ¨System.currentTimeMillisä¸­è½»æ¾å®ç°å®Œæ•´çš„msåˆ†è¾¨ç‡ã€‚ä½†è¿™å¹¶éæ€»æ˜¯å¦‚æ­¤ã€‚System.nanoTimeå½“ç„¶ä¸ä¼šå…·æœ‰å…¶å®Œæ•´çš„ç†è®ºåˆ†è¾¨ç‡ï¼š1ns = 10\-9 så¯¹åº”äº1GHzã€‚å› æ­¤ï¼Œåœ¨å…·æœ‰3GHzçš„CPUä¸Šï¼Œè¿™å°†å…è®¸çº¦3æ¡æŒ‡ä»¤æ¥æ‰§è¡Œè°ƒç”¨ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¤Ÿçš„ã€‚æˆ‘æµ‹é‡äº†800nsè‡³1000000nsï¼ˆ1msï¼‰ä¹‹é—´çš„è¾ƒå¤§æŠ–åŠ¨ã€‚æ¸…æ¥šåœ°æ¯100çº³ç§’è°ƒç”¨gettimeofdayæ˜¯æµªè´¹çš„ã€‚

å¤§å¤šæ•°æ—¶å€™ï¼Œæ‚¨ä¸éœ€è¦å½“å‰æ—¶é—´ã€‚å°†å…¶ç¼“å­˜åœ¨å¾ªç¯ä¹‹å¤–æ˜¯å¾®ä¸è¶³é“çš„ã€‚è¿™æ ·ï¼Œæ‚¨åªéœ€è®¿é—®ä¸€æ¬¡è®¡æ—¶å™¨ã€‚å¦‚æœç¡®å®éœ€è¦å…¶ä»–å¯¹è±¡ï¼Œæ‚¨ä»ç„¶å¯ä»¥å†³å®šå…‹éš†Dateå®ä¾‹ã€‚ä¸è®¡æ—¶å™¨è®¿é—®ç›¸æ¯”ï¼Œå…‹éš†éå¸¸ä¾¿å®œï¼ˆæˆ‘çš„ç³»ç»Ÿä¸­ä¸º50ï¼‰ã€‚
```
Date d = new Date();
for (E entity : entities) {
  entity.doSomething();
  entity.setUpdated((Date) d.clone());
}
```
å¦‚æœå¾ªç¯è¿è¡Œè¶…è¿‡å‡ æ¯«ç§’ï¼Œåˆ™å¯èƒ½æ— æ³•é€‰æ‹©ç¼“å­˜æ—¶é—´ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥è®¾ç½®ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œä»¥ä½¿ç”¨å½“å‰æ—¶é—´å®šæœŸæ›´æ–°æ—¶é—´æˆ³å˜é‡ï¼ˆä½¿ç”¨ä¸­æ–­ï¼‰ã€‚å°†å…¶è®¾ç½®ä¸ºæ‰€éœ€çš„ç¡®åˆ‡ç²’åº¦ã€‚ç²’åº¦è¶Šå¤§è¶Šå¥½ã€‚åœ¨æˆ‘çš„ç³»ç»Ÿä¸Šï¼Œæ­¤å¾ªç¯æ¯”æ¯æ¬¡åˆ›å»ºä¸€ä¸ªæ–°çš„Dateå¿«200å€ã€‚
```
private volatile long time;

Timer timer = new Timer(true);
try {
  time = System.currentTimeMillis();
  timer.scheduleAtFixedRate(new TimerTask() {
    public void run() {
      time = System.currentTimeMillis();
    }
  }, 0L, 10L); // granularity 10ms
  for (E entity : entities) {
     entity.doSomething();
     entity.setUpdated(new Date(time));
  }
} finally {
  timer.cancel();
}
```
### æŠ“ä½ä¸€åˆ‡ï¼šæˆ‘ä¸çŸ¥é“æ­£ç¡®çš„è¿è¡Œæ—¶å¼‚å¸¸
```
Query q = ...
Person p;
try {
    p = (Person) q.getSingleResult();
} catch(Exception e) {
    p = null;
}
```
è¿™æ˜¯ä¸€ä¸ªJ2EE EJB3æŸ¥è¯¢çš„ç¤ºä¾‹ã€‚å½“aï¼‰ç»“æœä¸æ˜¯å”¯ä¸€çš„ï¼Œbï¼‰æ²¡æœ‰ç»“æœcï¼‰å½“ç”±äºæ•°æ®åº“æ•…éšœè€Œæ— æ³•æ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼ŒgetSingleResultä¼šå¼•å‘è¿è¡Œæ—¶å¼‚å¸¸ã€‚ä¸Šé¢çš„ä»£ç æ•è·äº†ä»»ä½•å¼‚å¸¸ã€‚ä¸€ä¸ªå…¸å‹çš„ä¸‡èƒ½å—ã€‚ä½¿ç”¨ `null`ç»“æœå¯èƒ½æ˜¯bæƒ…å†µä¸‹æ­£ç¡®çš„äº‹æƒ…ï¼‰ï¼Œè€Œä¸æ˜¯æƒ…å†µä¸‹ï¼‰æˆ–cï¼‰ã€‚é€šå¸¸ï¼Œä¸åº”æ•è·è¿‡å¤šçš„å¼‚å¸¸ã€‚æ­£ç¡®çš„å¼‚å¸¸å¤„ç†æ˜¯
```
Query q = ...
Person p;
try {
    p = (Person) q.getSingleResult();
} catch(NoResultException e) {
    p = null;
}
```
### å¼‚å¸¸å¾ˆçƒ¦äºº
```
try {
    doStuff();
} catch(Exception e) {
    log.fatal("Could not do stuff");
}
doMoreStuff();
```
è¿™å°æ®µä»£ç æœ‰ä¸¤ä¸ªé—®é¢˜ã€‚é¦–å…ˆï¼Œå¦‚æœè¿™ç¡®å®æ˜¯ä¸€ä¸ªè‡´å‘½çŠ¶å†µï¼Œåˆ™è¯¥æ–¹æ³•åº”è¯¥ä¸­æ­¢å¹¶ä»¥é€‚å½“çš„å¼‚å¸¸é€šçŸ¥è‡´å‘½çŠ¶å†µï¼ˆä¸ºä»€ä¹ˆå®ƒé¦–å…ˆè¢«æ•è·äº†ï¼Ÿï¼‰åœ¨å‡ºç°è‡´å‘½çŠ¶å†µä¹‹åï¼Œæ‚¨å‡ ä¹æ°¸è¿œæ— æ³•ç»§ç»­ã€‚å…¶æ¬¡ï¼Œç”±äºå¤±è´¥åŸå› ä¸¢å¤±ï¼Œå› æ­¤å¾ˆéš¾è°ƒè¯•è¯¥ä»£ç ã€‚å¼‚å¸¸å¯¹è±¡åŒ…å«æœ‰å…³é”™è¯¯å‘ç”Ÿçš„ä½ç½®ä»¥åŠå¯¼è‡´é”™è¯¯çš„åŸå› çš„è¯¦ç»†ä¿¡æ¯ã€‚å„ä¸ªå­ç±»å®é™…ä¸Šå¯èƒ½æºå¸¦è®¸å¤šé¢å¤–çš„ä¿¡æ¯ï¼Œè°ƒç”¨è€…å¯ä»¥ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥é€‚å½“åœ°å¤„ç†è¿™ç§æƒ…å†µã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„é”™è¯¯ä»£ç ï¼ˆåœ¨Cè¯­è¨€ä¸­éå¸¸æµè¡Œã€‚åªéœ€æŸ¥çœ‹Linuxå†…æ ¸ã€‚åœ¨ä»»ä½•åœ°æ–¹éƒ½è¿”å›-EINVAL ...ï¼‰ã€‚å¦‚æœæ•è·é«˜çº§å¼‚å¸¸ï¼Œåˆ™è‡³å°‘è®°å½•æ¶ˆæ¯å’Œå †æ ˆè·Ÿè¸ªã€‚æ‚¨ä¸åº”å°†ä¾‹å¤–è§†ä¸ºå¿…è¦çš„é‚ªæ¶ã€‚å®ƒä»¬æ˜¯é”™è¯¯å¤„ç†çš„å¥½å·¥å…·ã€‚
```
try {
    doStuff();
} catch(Exception e) {
    throw new MyRuntimeException(e.getMessage(), e);
}
```
### é‡æ–°åŒ…è£…RuntimeException
```
try {
  doStuff();
} catch(Exception e) {
  throw new RuntimeException(e);
}
```
æœ‰æ—¶æ‚¨çœŸçš„æƒ³å°†ä»»ä½•æ£€æŸ¥åˆ°çš„å¼‚å¸¸é‡æ–°æŠ›å‡ºä¸ºRuntimeExceptionã€‚ä¸Šé¢çš„ä»£ç æ²¡æœ‰è€ƒè™‘åˆ°ï¼Œä½†æ˜¯RuntimeExceptionæ‰©å±•äº†Exceptionã€‚RuntimeExceptionä¸éœ€è¦åœ¨è¿™é‡Œæ•è·ã€‚æ­¤å¤–ï¼Œå¼‚å¸¸çš„æ¶ˆæ¯ä¹Ÿæ— æ³•æ­£ç¡®ä¼ æ’­ã€‚æ›´å¥½çš„æ–¹æ³•æ˜¯åˆ†åˆ«æ•è·RuntimeExceptionè€Œä¸åŒ…è£…å®ƒã€‚æ›´å¥½çš„åŠæ³•æ˜¯å•ç‹¬æ•è·æ‰€æœ‰æ£€æŸ¥çš„å¼‚å¸¸ï¼ˆå³ä½¿å®ƒä»¬å¾ˆå¤šï¼‰ã€‚
```
try {
  doStuff();
} catch(RuntimeException e) {
  throw e;
} catch(Exception e) {
  throw new RuntimeException(e.getMessage(), e);
}

try {
  doStuff();
} catch(IOException e) {
  throw new RuntimeException(e.getMessage(), e);
} catch(NamingException e) {
  throw new RuntimeException(e.getMessage(), e);
}
```
### æ²¡æœ‰æ­£ç¡®ä¼ æ’­å¼‚å¸¸
```
try {
} catch(ParseException e) {
  throw new RuntimeException();
  throw new RuntimeException(e.toString());
  throw new RuntimeException(e.getMessage());
  throw new RuntimeException(e);
}
```
è¯¥ä»£ç åªæ˜¯ä»¥ä¸åŒçš„æ–¹å¼å°†è§£æé”™è¯¯åŒ…è£…åˆ°è¿è¡Œæ—¶å¼‚å¸¸ä¸­ã€‚å®ƒä»¬éƒ½æ²¡æœ‰ä¸ºå‘¼å«è€…æä¾›çœŸæ­£å¥½çš„ä¿¡æ¯ã€‚ç¬¬ä¸€ä¸ªåªä¼šä¸¢å¤±æ‰€æœ‰ä¿¡æ¯ã€‚ç¬¬äºŒç§æ–¹æ³•å¯ä»¥æ‰§è¡Œä»»ä½•æ“ä½œï¼Œå…·ä½“å–å†³äºtoStringï¼ˆï¼‰äº§ç”Ÿä»€ä¹ˆä¿¡æ¯ã€‚é»˜è®¤çš„toStringï¼ˆï¼‰å®ç°åˆ—å‡ºäº†å®Œå…¨é™å®šçš„å¼‚å¸¸åç§°ï¼Œåè·Ÿæ¶ˆæ¯ã€‚åµŒå¥—è®¸å¤šå¼‚å¸¸å°†äº§ç”Ÿç¬¨æ‹™ä¸”å†—é•¿çš„å­—ç¬¦ä¸²ï¼Œä¸é€‚åˆç”¨æˆ·ã€‚ç¬¬ä¸‰åªä¿ç•™æ¶ˆæ¯ï¼Œæ€»æ¯”æ²¡æœ‰å¥½ã€‚æœ€åä¸€ä¸ªä¿ç•™åŸå› ï¼Œä½†å°†è¿è¡Œæ—¶å¼‚å¸¸çš„æ¶ˆæ¯è®¾ç½®ä¸ºå…¶åŸå› çš„toStringï¼ˆï¼‰ï¼ˆè¯·å‚è§ä¸Šæ–‡ï¼‰ã€‚æœ€æœ‰ç”¨ï¼Œæœ€æ˜“è¯»çš„ç‰ˆæœ¬æ˜¯åœ¨è¿è¡Œæ—¶å¼‚å¸¸ä¸­ä»…ä¼ æ’­åŸå› æ¶ˆæ¯ï¼Œå¹¶å°†åŸå§‹å¼‚å¸¸ä½œä¸ºåŸå› ä¼ é€’ï¼š
```
try {
} catch(ParseException e) {
  throw new RuntimeException(e.getMessage(), e);
}
```
### æ„šè ¢çš„å¼‚å¸¸æ¶ˆæ¯
```
try {
} catch (ParseException e) {
  throw new RuntimeException("\*\*\*\* --> OMFG something scary happened !!!!11! <---");
}
```
è¿™ä¸ªå¼‚å¸¸æ˜¯æ²¡æœ‰ç”¨çš„ã€‚å®ƒä¸ä¼šç»™å‘¼å«è€…ä»»ä½•æŒ‡ç¤ºåŸå› ã€‚ç›¸åï¼Œå®ƒåŒ…å«ASCIIè‰ºæœ¯å’Œæƒ…æ„Ÿç”¨è¯­ï¼Œå¯¹ä»»ä½•äººéƒ½æ²¡æœ‰å¸®åŠ©ã€‚æ·»åŠ æœ‰ç”¨çš„ä¿¡æ¯æˆ–ç®€å•åœ°ä¼ é€’åŸå§‹å¼‚å¸¸çš„æ¶ˆæ¯ã€‚ä¸è¦åœ¨åŸå§‹æ¶ˆæ¯å‰æ·»åŠ è‡ªå®šä¹‰â€œæ“ä½œå¤±è´¥ï¼Œå› ä¸ºï¼šâ€å­—ç¬¦ä¸²ã€‚è¿™æ²¡ç”¨ã€‚å¹¶å°†è¯¥å­—ç¬¦ä¸²æ·»åŠ åˆ°å¸¸é‡æ± ä¸­ï¼Œè¯¥å¸¸é‡æ± å°†åœ¨å¤§å‹åº”ç”¨ç¨‹åºä¸­å……æ»¡æ— ç”¨çš„å­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²æ˜¯å·²ç¼–è¯‘åº”ç”¨ç¨‹åºä¸­çš„é¡¶çº§ç©ºé—´ä½¿ç”¨è€…ã€‚
```
try {
} catch (ParseException e) {
  // for code so it gets access to some context
  throw new MyException(input, e);
  // for humans
  throw new RuntimeException(input +": "+ e.getMessage(), e);
  // or simply
  throw new RuntimeException(e.getMessage(), e);
}
```
### æ•æ‰æ—¥å¿—
```
try {
    ...
} catch(ExceptionA e) {
    log.error(e.getMessage(), e);
    throw e;
} catch(ExceptionB e) {
    log.error(e.getMessage(), e);
    throw e;
}
```
æ­¤ä»£ç ä»…æ•è·å¼‚å¸¸ä»¥å†™å‡ºä¸€æ¡æ—¥å¿—è¯­å¥ï¼Œç„¶åé‡æ–°å¼•å‘ç›¸åŒçš„å¼‚å¸¸ã€‚çœŸå‚» è®©è°ƒç”¨è€…å†³å®šæ¶ˆæ¯æ˜¯å¦å¯¹æ—¥å¿—è®°å½•å¾ˆé‡è¦å¹¶åˆ é™¤æ•´ä¸ªtry / catchå­å¥ã€‚ä»…å½“æ‚¨çŸ¥é“å‘¼å«è€…æœªè®°å½•å®ƒæ—¶ï¼Œå®ƒæ‰æœ‰ç”¨ã€‚å¦‚æœä¸æ˜¯ç”±æ‚¨æ§åˆ¶çš„æ¡†æ¶è°ƒç”¨è¯¥æ–¹æ³•ï¼Œå°±æ˜¯è¿™ç§æƒ…å†µã€‚å¦‚æœæ‚¨å› ä¸ºè°ƒç”¨è€…æ²¡æœ‰è¶³å¤Ÿçš„ä¿¡æ¯æ¥è®°å½•æ—¥å¿—ï¼Œé‚£ä¹ˆæ‚¨çš„å¼‚å¸¸ç±»æ˜¯ä¸åˆé€‚çš„ï¼šå°†æ‰€æœ‰å¿…éœ€çš„ä¿¡æ¯ä¸€èµ·ä¼ é€’ç»™å¼‚å¸¸ã€‚é‚£å°±æ˜¯ä»–ä»¬çš„ç›®çš„ï¼

### ä¸å®Œæ•´çš„å¼‚å¸¸å¤„ç†
```
try {
    is = new FileInputStream(inFile);
    os = new FileOutputStream(outFile);
} finally {
    try {
        is.close();
        os.close();
    } catch(IOException e) {
        /\* we can't do anything \*/
    }
}
```
å¦‚æœæœªå…³é—­æµï¼Œåˆ™åº•å±‚æ“ä½œç³»ç»Ÿæ— æ³•é‡Šæ”¾æœ¬æœºèµ„æºã€‚è¿™ä½ç¨‹åºå‘˜æƒ³è¦å…³é—­ä¸¤ä¸ªæµæ—¶è¦å°å¿ƒã€‚æ‰€ä»¥ä»–æŠŠç»“æŸè¯­æ”¾åœ¨äº†ä¸€ä¸ª`finally`æ¡æ¬¾ä¸­ã€‚ä½†æ˜¯ï¼Œå¦‚æœ`is.close()`æŠ›å‡ºIOExceptionï¼Œåˆ™ `os.close`ç”šè‡³ä¸ä¼šæ‰§è¡Œã€‚ä¸¤ä¸ªcloseè¯­å¥å¿…é¡»åŒ…è£…åœ¨å®ƒä»¬è‡ªå·±çš„try / catchå­å¥ä¸­ã€‚æ­¤å¤–ï¼Œå¦‚æœåˆ›å»ºè¾“å…¥æµå¼•å‘å¼‚å¸¸ï¼ˆå› ä¸ºæœªæ‰¾åˆ°æ–‡ä»¶ï¼‰ï¼Œ`os`åˆ™ä¸ºnullå¹¶`os.close()`å¼•å‘`NullPointerException`ã€‚ä¸ºäº†ä½¿å®ƒä¸é‚£ä¹ˆå†—é•¿ï¼Œæˆ‘åˆ é™¤äº†ä¸€äº›æ¢è¡Œç¬¦ã€‚
```
try {
    is = new FileInputStream(inFile);
    os = new FileOutputStream(outFile);
} finally {
    try { if (is != null) is.close(); } catch(IOException e) {/\* we can't do anything \*/}
    try { if (os != null) os.close(); } catch(IOException e) {/\* we can't do anything \*/}
}
```
### æ°¸è¿œä¸ä¼šå‘ç”Ÿçš„ä¾‹å¤–
```
try {
  ... do risky stuff ...
} catch(SomeException e) {
  // never happens
}
... do some more ...
```
åœ¨è¿™é‡Œï¼Œå¼€å‘äººå‘˜åœ¨try / catchå—ä¸­æ‰§è¡Œä¸€äº›ä»£ç ã€‚ä»–ä¸æƒ³å°†è¢«è°ƒç”¨çš„æ–¹æ³•ä¹‹ä¸€å£°æ˜çš„å¼‚å¸¸æŠ›å‡ºä»–çš„çƒ¦æ¼ã€‚ç”±äºå¼€å‘äººå‘˜å¾ˆèªæ˜ï¼Œä»–çŸ¥é“åœ¨ä»–çš„ç‰¹å®šæƒ…å†µä¸‹æ°¸è¿œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå› æ­¤ä»–åªæ˜¯æ’å…¥ä¸€ä¸ªç©ºçš„catchå—ã€‚ä»–ç”šè‡³åœ¨ç©ºç™½çš„catchåŒºåŸŸä¸­æ·»åŠ äº†ä¸€ä¸ªä¸é”™çš„æ³¨é‡Š-ä½†å®ƒä»¬æ˜¯è‘—åçš„é—è¨€...é—®é¢˜æ˜¯ï¼šä»–å¦‚ä½•ç¡®å®šï¼Ÿå¦‚æœè¢«è°ƒç”¨æ–¹æ³•çš„å®ç°å‘ç”Ÿå˜åŒ–æ€ä¹ˆåŠï¼Ÿå¦‚æœåœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ä»ç„¶æŠ›å‡ºå¼‚å¸¸ï¼Œä½†ä»–åªæ˜¯æ²¡æœ‰æƒ³åˆ°è¯¥æ€ä¹ˆåŠï¼Ÿåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œtry / catchä¹‹åçš„ä»£ç å¯èƒ½ä¼šåšé”™äº‹æƒ…ã€‚è¯¥å¼‚å¸¸å°†å®Œå…¨ä¸è¢«æ³¨æ„åˆ°ã€‚é€šè¿‡åœ¨è¿™ç§æƒ…å†µä¸‹æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¯ä»¥ä½¿ä»£ç æ›´åŠ å¯é ã€‚è¿™å°±åƒæ–­è¨€ä¸€æ ·ï¼Œå¹¶éµå¾ªâ€œ
```
try {
  ... do risky stuff ...
} catch(SomeException e) {
  // never happens hopefully
  throw new IllegalStateException(e.getMessage(), e); // crash early, passing all information
}
... do some more ...
```
### ç¬æ€é™·é˜±
```
public class A implements Serializable {
    private String someState;
    private transient Log log = LogFactory.getLog(getClass());
    
    public void f() {
        log.debug("enter f");
        ...
    }
}
```
æ—¥å¿—å¯¹è±¡ä¸å¯åºåˆ—åŒ–ã€‚ç¨‹åºå‘˜çŸ¥é“è¿™ä¸€ç‚¹ï¼Œå¹¶æ­£ç¡®åœ°å°†è¯¥`log`å­—æ®µå£°æ˜ä¸ºç¬æ€ï¼Œå› æ­¤ä¸è¿›è¡Œåºåˆ—åŒ–ã€‚ä½†æ˜¯ï¼Œæ­¤å˜é‡çš„åˆå§‹åŒ–å‘ç”Ÿåœ¨ç±»çš„åˆå§‹åŒ–ç¨‹åºä¸­ã€‚ååºåˆ—åŒ–æ—¶ï¼Œä¸æ‰§è¡Œåˆå§‹åŒ–ç¨‹åºå’Œæ„é€ å‡½æ•°ï¼è¿™`log`å°†ä½¿ååºåˆ—åŒ–çš„å¯¹è±¡å…·æœ‰null å˜é‡ï¼Œè¯¥å˜é‡éšåå¯¼è‡´`NullPointerException`in `f()`ã€‚ç»éªŒæ³•åˆ™ï¼šåˆ‡å‹¿å°†ç±»åˆå§‹åŒ–ä¸ç¬æ€å˜é‡ä¸€èµ·ä½¿ç”¨ã€‚æ‚¨å¯ä»¥åœ¨æ­¤å¤„é€šè¿‡ä½¿ç”¨é™æ€å˜é‡æˆ–é€šè¿‡ä½¿ç”¨å±€éƒ¨å˜é‡æ¥è§£å†³è¿™ç§æƒ…å†µï¼š
```
public class A implements Serializable {
    private String someState;
    private static final Log log = LogFactory.getLog(A.class);
    
    public void f() {
        log.debug("enter f");
        ...
    }
}

public class A implements Serializable {
    private String someState;
    
    public void f() {
        Log log = LogFactory.getLog(getClass());
        log.debug("enter f");
        ...
    }
}
```
### è¿‡åº¦æ€ä¼¤åˆå§‹åŒ–
```
public class B {
    private int count = 0;
    private String name = null;
    private boolean important = false;
}
```
è¿™ä½ç¨‹åºå‘˜æ›¾ç»ä½¿ç”¨Cè¯­è¨€è¿›è¡Œç¼–ç¨‹ã€‚å› æ­¤ï¼Œä»–è‡ªç„¶å¸Œæœ›ç¡®ä¿æ¯ä¸ªå˜é‡éƒ½å·²æ­£ç¡®åˆå§‹åŒ–ã€‚ä½†æ˜¯ï¼Œè¿™é‡Œæ²¡æœ‰å¿…è¦ã€‚Javaè¯­è¨€è§„èŒƒä¿è¯æˆå‘˜å˜é‡ä¼šè‡ªåŠ¨ä½¿ç”¨æŸäº›å€¼åˆå§‹åŒ–ï¼š0ï¼Œnullï¼Œfalseã€‚é€šè¿‡æ˜¾å¼å£°æ˜å®ƒä»¬ï¼Œç¨‹åºå‘˜ä½¿ç±»åˆå§‹åŒ–ç¨‹åºåœ¨æ„é€ å‡½æ•°ä¹‹å‰æ‰§è¡Œã€‚è¿™æ˜¯ä¸å¿…è¦çš„è¿‡åº¦æ€ä¼¤ï¼Œåº”è¯¥é¿å…ã€‚
```
public class B {
    private int count;
    private String name;
    private boolean important;
}
```
### æ—¥å¿—å®ä¾‹ï¼šé™æ€è¿˜æ˜¯éé™æ€ï¼Ÿ

æœ¬èŠ‚å·²ç»è¿‡ç¼–è¾‘ï¼Œåœ¨å®é™…ä¸å»ºè®®å°†æ—¥å¿—å®ä¾‹å­˜å‚¨åœ¨é™æ€å˜é‡ä¸­ä¹‹å‰ã€‚åŸæ¥æˆ‘é”™äº†ã€‚Mea culpaã€‚æˆ‘é“æ­‰ã€‚  
å°†ç»‡è¡¥æ—¥å¿—å®ä¾‹å­˜å‚¨åœ¨é™æ€çš„finalå˜é‡ä¸­å¹¶æ„Ÿåˆ°é«˜å…´ã€‚
```
private static final Log log = LogFactory.getLog(MyClass.class);
```
åŸå› å¦‚ä¸‹ï¼š

*   è‡ªåŠ¨çº¿ç¨‹å®‰å…¨ã€‚ä½†ä»…åŒ…å«æœ€ç»ˆå…³é”®å­—ï¼
*   å¯ç”¨äºé™æ€å’Œéé™æ€ä»£ç ã€‚
*   å¯åºåˆ—åŒ–ç±»æ²¡æœ‰é—®é¢˜ã€‚
*   åˆå§‹åŒ–åªéœ€èŠ±è´¹ä¸€æ¬¡ï¼šgetLogï¼ˆï¼‰å¯èƒ½ä¸åƒæ‚¨æƒ³è±¡çš„é‚£æ ·ä¾¿å®œã€‚
*   æ— è®ºå¦‚ä½•ï¼Œæ²¡äººä¼šå¸è½½Logç±»åŠ è½½å™¨ã€‚

### é€‰æ‹©é”™è¯¯çš„ç±»åŠ è½½å™¨
```
Class clazz = Class.forName(name);
Class clazz = getClass().getClassLoader().loadClass(name);
```
è¯¥ä»£ç ä½¿ç”¨åŠ è½½å½“å‰ç±»çš„ç±»åŠ è½½å™¨ã€‚getClassï¼ˆï¼‰å¯èƒ½ä¼šè¿”å›æ„å¤–çš„å†…å®¹ï¼Œä¾‹å¦‚å­ç±»æˆ–åŠ¨æ€ä»£ç†ã€‚è¶…å‡ºæ‚¨çš„æ§åˆ¶èŒƒå›´ã€‚åŠ¨æ€åŠ è½½å…¶ä»–ç±»æ—¶ï¼Œè¿™å‡ ä¹ä¸æ˜¯æ‚¨æƒ³è¦çš„ã€‚å°¤å…¶æ˜¯åœ¨è¯¸å¦‚åº”ç”¨ç¨‹åºæœåŠ¡å™¨ï¼ŒServletå¼•æ“æˆ–Java Webstartä¹‹ç±»çš„æ‰˜ç®¡ç¯å¢ƒä¸­ï¼Œè¿™æ— ç–‘æ˜¯é”™è¯¯çš„ã€‚å–å†³äºè¿è¡Œçš„ç¯å¢ƒï¼Œæ­¤ä»£ç çš„è¡Œä¸ºå°†æœ‰å¾ˆå¤§ä¸åŒã€‚ç¯å¢ƒä½¿ç”¨ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ä¸ºåº”ç”¨ç¨‹åºæä¾›åº”ç”¨äºæ£€ç´¢â€œè‡ªå·±çš„â€ç±»çš„ç±»åŠ è½½å™¨ã€‚
```
ClassLoader cl = Thread.currentThread().getContextClassLoader();
if (cl == null) cl = MyClass.class.getClassLoader(); // fallback
Class clazz = cl.loadClass(name);
```
### ä½¿ç”¨åå°„ä¸è‰¯
```
Class beanClass = ...
if (beanClass.newInstance() instanceof TestBean) ...
```
è¿™ä½ç¨‹åºå‘˜æ­£åœ¨åŠªåŠ›ä½¿ç”¨åå°„APIã€‚ä»–éœ€è¦ä¸€ç§æ£€æŸ¥ç»§æ‰¿çš„æ–¹æ³•ï¼Œä½†æ²¡æœ‰æ‰¾åˆ°ä¸€ç§æ–¹æ³•ã€‚å› æ­¤ï¼Œä»–åªæ˜¯åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹å¹¶ä½¿ç”¨`instanceof`ä»–ä¹ æƒ¯çš„è¿ç®—ç¬¦ã€‚åˆ›å»ºæ‚¨ä¸çŸ¥é“çš„ç±»çš„å®ä¾‹å¾ˆå±é™©ã€‚æ‚¨æ°¸è¿œéƒ½ä¸çŸ¥é“è¯¥ç±»åšä»€ä¹ˆã€‚å®ƒå¯èƒ½éå¸¸æ˜‚è´µã€‚å¦åˆ™é»˜è®¤æ„é€ å‡½æ•°å¯èƒ½ç”šè‡³ä¸å­˜åœ¨ã€‚ç„¶åï¼Œæ­¤ifè¯­å¥å°†å¼•å‘å¼‚å¸¸ã€‚è¿›è¡Œæ­¤æ£€æŸ¥çš„æ­£ç¡®æ–¹æ³•æ˜¯ä½¿ç”¨`Class.isAssignableFrom(Class)` æ–¹æ³•ã€‚å®ƒçš„è¯­ä¹‰æ˜¯é¢ å€’çš„`instanceof`ã€‚
```
Class beanClass = ...
if (TestBean.class.isAssignableFrom(beanClass)) ...
```
### åŒæ­¥è¿‡åº¦æ€ä¼¤åŠ›
```
Collection l = new Vector();
for (...) {
   l.add(object);
}
```
`Vector`æ˜¯åŒæ­¥çš„`ArrayList`ã€‚å¹¶ä¸”`Hashtable`æ˜¯åŒæ­¥çš„`HashMap`ã€‚åªæœ‰æ˜ç¡®éœ€è¦åŒæ­¥æ—¶ï¼Œæ‰åº”ä½¿ç”¨ä¸¤ä¸ªç±»ã€‚ä½†æ˜¯ï¼Œå¦‚æœå°†è¿™äº›é›†åˆç”¨ä½œæœ¬åœ°ä¸´æ—¶å˜é‡ï¼Œåˆ™åŒæ­¥å°†å®Œå…¨è¢«æ·˜æ±°ï¼Œä»è€Œå¤§å¤§é™ä½æ€§èƒ½ã€‚æˆ‘æµ‹ç®—äº†25ï¼…çš„ç½šæ¬¾ã€‚
```
Collection l = new ArrayList();
for (...) {
   l.add(object);
}
```
### åˆ—è¡¨ç±»å‹é”™è¯¯

æ²¡æœ‰ç¤ºä¾‹ä»£ç ã€‚åˆçº§å¼€å‘äººå‘˜é€šå¸¸å¾ˆéš¾é€‰æ‹©æ­£ç¡®çš„åˆ—è¡¨ç±»å‹ã€‚ä»–ä»¬é€šå¸¸ä¼šé€‰æ‹©ä»éå¸¸éšæ„ `Vector`ï¼Œ`ArrayList`å’Œ`LinkedList`ã€‚ä½†æ˜¯éœ€è¦è€ƒè™‘æ€§èƒ½ï¼å½“é€šè¿‡ç´¢å¼•æ·»åŠ ï¼Œè¿­ä»£æˆ–è®¿é—®å¯¹è±¡æ—¶ï¼Œå®ç°çš„è¡Œä¸ºæœ‰å¾ˆå¤§ä¸åŒã€‚åœ¨æ­¤åˆ—è¡¨ä¸­ï¼Œæˆ‘å°†å¿½ç•¥Vectorï¼Œå› ä¸ºå®ƒçš„è¡Œä¸ºç±»ä¼¼äºArrayListï¼Œåªæ˜¯é€Ÿåº¦è¾ƒæ…¢ã€‚æ³¨æ„ï¼šnæ˜¯åˆ—è¡¨çš„å¤§å°ï¼Œè€Œä¸æ˜¯æ“ä½œæ•°ï¼æˆ‘åœ¨è¿™é‡Œé¿å…ä½¿ç”¨Oï¼ˆï¼‰è¡¨ç¤ºæ³•ï¼Œå› ä¸ºå®ƒä¸èƒ½ç»™å‡ºæ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…çš„æœ‰ç”¨å›¾åƒã€‚è¯¥è¡¨åˆ—å‡ºäº†åˆ—è¡¨æ“ä½œçš„æˆæœ¬ã€‚
|        | æ•°ç»„åˆ—è¡¨                  | é“¾è¡¨    |
|--------|-----------------------|-------|
| æ·»åŠ ï¼ˆè¿½åŠ ï¼‰ | constæˆ–ã€œlogï¼ˆnï¼‰ï¼ˆå¦‚æœå¢é•¿ï¼‰   | const |
| æ’å…¥ï¼ˆä¸­é—´ï¼‰ | çº¿æ€§æˆ–ã€œn \* logï¼ˆnï¼‰ï¼ˆå¦‚æœå¢é•¿ï¼‰ | çº¿æ€§çš„   |
| åˆ é™¤ï¼ˆä¸­ï¼‰  | çº¿æ€§ï¼ˆå§‹ç»ˆæ‰§è¡Œå®Œæ•´å¤åˆ¶ï¼‰          | çº¿æ€§çš„   |
| é‡å¤     | çº¿æ€§çš„                   | çº¿æ€§çš„   |
| é€šè¿‡ç´¢å¼•è·å– | const                 | çº¿æ€§çš„   |


ArrayListçš„æ’å…¥æ€§èƒ½å–å†³äºå®ƒåœ¨æ’å…¥æœŸé—´æ˜¯å¦å¿…é¡»å¢å¤§ï¼Œæˆ–è€…æ˜¯å¦åˆç†è®¾ç½®äº†åˆå§‹å¤§å°ã€‚å¢é•¿å‘ˆæŒ‡æ•°å¢é•¿ï¼ˆå› æ•°2ï¼‰ï¼Œå› æ­¤å¢é•¿æˆæœ¬æ˜¯å¯¹æ•°çš„ã€‚ä½†æ˜¯ï¼ŒæŒ‡æ•°å¢é•¿å¯èƒ½ä¼šä½¿ç”¨æ¯”å®é™…éœ€è¦æ›´å¤šçš„å†…å­˜ã€‚çªç„¶éœ€è¦è°ƒæ•´åˆ—è¡¨å¤§å°ä¹Ÿä½¿å“åº”æ—¶é—´å˜æ…¢ï¼Œå¹¶ä¸”å¦‚æœåˆ—è¡¨å¾ˆå¤§ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¤§é‡åƒåœ¾å›æ”¶ã€‚éå†åˆ—è¡¨åŒæ ·ä¾¿å®œã€‚ä½†æ˜¯ï¼Œåœ¨é“¾æ¥åˆ—è¡¨ä¸­ï¼Œå¯¹ç´¢å¼•åˆ—è¡¨å…ƒç´ çš„è®¿é—®éå¸¸æ…¢ã€‚  
å†…å­˜æ³¨æ„äº‹é¡¹ï¼šLinkedListå°†æ¯ä¸ªå…ƒç´ åŒ…è£…åˆ°åŒ…è£…å¯¹è±¡ä¸­ã€‚ArrayListæ¯æ¬¡éœ€è¦å¢é•¿æ—¶éƒ½ä¼šåˆ†é…ä¸€ä¸ªå…¨æ–°çš„æ•°ç»„ï¼Œå¹¶åœ¨æ¯ä¸ªremoveï¼ˆï¼‰ä¸Šæ‰§è¡Œæ•°ç»„å¤åˆ¶ã€‚æ‰€æœ‰æ ‡å‡†Collectionéƒ½ä¸èƒ½é‡ç”¨å…¶Iteratorå¯¹è±¡ï¼Œè¿™å¯èƒ½å¯¼è‡´Iteratoræµå¤±ï¼Œå°¤å…¶æ˜¯åœ¨é€’å½’è¿­ä»£å¤§å‹æ ‘ç»“æ„æ—¶ã€‚  
æˆ‘ä¸ªäººå‡ ä¹ä»ä¸ä½¿ç”¨LinkedListã€‚ä»…å½“æ‚¨æƒ³åœ¨åˆ—è¡¨ä¸­é—´æ’å…¥å¯¹è±¡æ—¶ï¼Œè¿™æ‰æœ‰æ„ä¹‰ã€‚ä½†æ˜¯ï¼Œç”±äºæ— æ³•è®¿é—®åŒ…è£…å¯¹è±¡ï¼Œå› æ­¤æ— æ³•ç¼©æ”¾å¹¶ä¸”å…·æœ‰çº¿æ€§æˆæœ¬ï¼Œå› ä¸ºå¿…é¡»é¦–å…ˆéå†åˆ—è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°æ’å…¥ä½ç½®ã€‚é‚£ä¹ˆï¼ŒLinkedListç±»çš„ç¡®åˆ‡å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘å»ºè®®ä»…ä½¿ç”¨ArrayListsã€‚

### HashMapå¤§å°é™·é˜±
```
Map map = new HashMap(collection.size());
for (Object o : collection) {
  map.put(o.key, o.value);
}
```
è¯¥å¼€å‘äººå‘˜æœ‰è‰¯å¥½çš„æ„æ„¿ï¼Œå¹¶å¸Œæœ›ç¡®ä¿ä¸éœ€è¦è°ƒæ•´HashMapçš„å¤§å°ã€‚å› æ­¤ï¼Œä»–å°†å…¶åˆå§‹å¤§å°è®¾ç½®ä¸ºè¦æ”¾å…¥å…¶ä¸­çš„å…ƒç´ æ•°é‡ã€‚ä¸å¹¸çš„æ˜¯ï¼ŒHashMapå®ç°å¹¶ä¸å®Œå…¨åƒè¿™æ ·ã€‚å®ƒå°†å†…éƒ¨é˜ˆå€¼è®¾ç½®ä¸º `threshold = (int)(capacity * loadFactor)`ã€‚å› æ­¤ï¼Œåœ¨å°†é›†åˆçš„75ï¼…æ’å…¥åœ°å›¾åï¼Œå®ƒå°†è°ƒæ•´å¤§å°ã€‚å› æ­¤ï¼Œä»¥ä¸Šä»£ç å°†å§‹ç»ˆå¯¼è‡´é¢å¤–çš„åƒåœ¾ã€‚
```
Map map = new HashMap(1 + (int) (collection.size() / 0.75));
```
### Hashtableï¼ŒHashMapå’ŒHashSetè¢«é«˜ä¼°äº†

è¿™äº›è¯¾ç¨‹éå¸¸å—æ¬¢è¿ã€‚å› ä¸ºå®ƒä»¬å¯¹äºå¼€å‘äººå‘˜æ¥è¯´å…·æœ‰å¾ˆå¤§çš„å¯ç”¨æ€§ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå®ƒä»¬çš„æ•ˆç‡ä¹Ÿéå¸¸å·®ã€‚å½“æ‚¨æœ‰100ä¸ªæˆ–æ›´å¤šæ¡ç›®æ—¶ï¼Œå“ˆå¸Œè¡¨å°†å˜å¾—å¾ˆæœ‰ç”¨ã€‚ä½†æ˜¯ä¸åªæ˜¯ä¸€äº›è¦ç´ ã€‚åœ¨å…¸å‹çš„ä»£ç ä¸­ï¼Œæ­¤ç±»é›†åˆåŒ…å«å¤§çº¦10ä¸ªæ¡ç›®-é€‚åˆCPUç¼“å­˜è¡Œï¼Hashtableå’ŒHashMapå°†æ¯ä¸ªé”®/å€¼å¯¹åŒ…è£…åˆ°EntryåŒ…è£…å™¨å¯¹è±¡ä¸­ã€‚Entryå¯¹è±¡éå¸¸å¤§ã€‚å®ƒä¸ä»…ä¿å­˜å¯¹é”®å’Œå€¼çš„å¼•ç”¨ï¼Œè¿˜å­˜å‚¨å“ˆå¸Œç å’Œå¯¹å“ˆå¸Œå­˜å‚¨æ¡¶ä¸‹ä¸€ä¸ªEntryçš„æ­£å‘å¼•ç”¨ã€‚å½“æ‚¨ä½¿ç”¨å†…å­˜åˆ†æå™¨æŸ¥çœ‹å †è½¬å‚¨æ—¶ï¼Œæ‚¨ä¼šä¸ºå®ƒä»¬åœ¨å¤§å‹åº”ç”¨ç¨‹åºï¼ˆå¦‚åº”ç”¨ç¨‹åºæœåŠ¡å™¨ï¼‰ä¸­æµªè´¹å¤šå°‘ç©ºé—´è€Œæ„Ÿåˆ°éœ‡æƒŠã€‚  
åœ¨ä½¿ç”¨ä»»ä½•è¿™äº›ç±»ä¹‹å‰ï¼Œè¯·ä¸‰æ€ã€‚IdentityHashMapå¯èƒ½æ˜¯ä¸€ä¸ªå¯è¡Œçš„é€‰æ‹©ã€‚ä½†è¯·æ³¨æ„ï¼Œå®ƒæœ‰æ„ç ´åMapç•Œé¢ã€‚é€šè¿‡å®ç°å¼€æ”¾çš„å“ˆå¸Œè¡¨ï¼ˆæ— å­˜å‚¨æ¡¶ï¼‰ï¼Œä¸éœ€è¦EntryåŒ…è£…å™¨å¹¶ä½¿ç”¨ç®€å•çš„Object \[\]ä½œä¸ºå…¶åç«¯ï¼Œå¯ä»¥æé«˜å†…å­˜æ•ˆç‡ã€‚ä»£æ›¿HashSetï¼Œç®€å•çš„ArrayListå¯ä»¥åšå¾—å¾ˆå¥½ï¼ˆå¯ä»¥ä½¿ç”¨containsï¼ˆObjectï¼‰ï¼‰ï¼Œåªè¦å®ƒå¾ˆå°å¹¶ä¸”æŸ¥æ‰¾å¾ˆå°‘ã€‚  
å¯¹äºä»…åŒ…å«å°‘é‡æ¡ç›®çš„Setæ¥è¯´ï¼Œæ•´ä¸ªå“ˆå¸Œå¤„ç†æ˜¯å¤šä½™çš„ï¼Œå¹¶ä¸”HashMapåç«¯åŠ ä¸ŠåŒ…è£…å™¨å¯¹è±¡æ‰€æµªè´¹çš„å†…å­˜åªæ˜¯èƒ¡è¯´å…«é“ã€‚åªéœ€ä½¿ç”¨ArrayListç”šè‡³æ˜¯æ•°ç»„å³å¯ã€‚  
å®é™…ä¸Šï¼Œåœ¨æ ‡å‡†JDKä¸­æ²¡æœ‰æœ‰æ•ˆçš„Mapå’ŒSetå®ç°çœŸæ˜¯å¯æƒœï¼

### æ¸…å•è¢«é«˜ä¼°

Listçš„å®ç°ä¹Ÿå¾ˆå—æ¬¢è¿ã€‚ä½†æ˜¯ï¼Œç”šè‡³åˆ—è¡¨é€šå¸¸ä¹Ÿæ²¡æœ‰å¿…è¦ã€‚ç®€å•æ•°ç»„ä¹Ÿå¯ä»¥ã€‚æˆ‘å¹¶ä¸æ˜¯è¯´æ‚¨æ ¹æœ¬ä¸åº”è¯¥ä½¿ç”¨åˆ—è¡¨ã€‚ä»–ä»¬å¾ˆæ£’ã€‚ä½†æ˜¯çŸ¥é“ä½•æ—¶ä½¿ç”¨æ•°ç»„ã€‚ä»¥ä¸‹æ˜¯åº”è¯¥ä½¿ç”¨æ•°ç»„è€Œä¸æ˜¯åˆ—è¡¨çš„æŒ‡ç¤ºç¬¦ï¼š

*   åˆ—è¡¨çš„å¤§å°å›ºå®šã€‚ä¾‹å¦‚ï¼šæ˜ŸæœŸå‡ ã€‚ä¸€ç»„å¸¸æ•°ã€‚
*   è¯¥åˆ—è¡¨ç»å¸¸è¢«éå†ï¼ˆ10,000æ¬¡ï¼‰ã€‚
*   è¯¥åˆ—è¡¨åŒ…å«æ•°å­—çš„åŒ…è£…å¯¹è±¡ï¼ˆæ²¡æœ‰åŸå§‹ç±»å‹çš„åˆ—è¡¨ï¼‰ã€‚

è®©æˆ‘ç”¨ä»£ç è¯´æ˜ä¸€ä¸‹ï¼š
```
List<Integer> codes = new ArrayList<Integer>();
codes.add(Integer.valueOf(10));
codes.add(Integer.valueOf(20));
codes.add(Integer.valueOf(30));
codes.add(Integer.valueOf(40));

versus

int\[\] codes = { 10, 20, 30, 40 };

// horribly slow and a memory waster if l has a few thousand elements (try it yourself!)
List<Mergeable> l = ...;
for (int i=0; i < l.size()-1; i++) {
    Mergeable one = l.get(i);
    Iterator<Mergeable> j = l.iterator(i+1); // memory allocation!
    while (j.hasNext()) {
        Mergeable other = l.next();
        if (one.canMergeWith(other)) {
            one.merge(other);
            other.remove();
        }
    }
}

versus

// quite fast and no memory allocation
Mergeable\[\] l = ...;
for (int i=0; i < l.length-1; i++) {
    Mergeable one = l\[i\];
    for (int j=i+1; j < l.length; j++) {
        Mergeable other = l\[j\];
        if (one.canMergeWith(other)) {
            one.merge(other);
            l\[j\] = null;
        }
    }
}
```
æ‚¨å°†ä¿å­˜ä¸€ä¸ªé¢å¤–çš„åˆ—è¡¨å¯¹è±¡ï¼ˆåŒ…è£…ä¸€ä¸ªæ•°ç»„ï¼‰ï¼ŒåŒ…è£…å¯¹è±¡ä»¥åŠå¯èƒ½çš„è®¸å¤šè¿­ä»£å™¨å®ä¾‹ã€‚ç”šè‡³Sunä¹Ÿæ„è¯†åˆ°äº†è¿™ä¸€ç‚¹ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ [Collections.sortï¼ˆï¼‰](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Collections.html#sort(java.util.List)) å®é™…ä¸Šå°†åˆ—è¡¨å¤åˆ¶åˆ°æ•°ç»„ä¸­å¹¶å¯¹æ•°ç»„æ‰§è¡Œæ’åºçš„åŸå› ã€‚  

### å¯¹è±¡æ•°ç»„éå¸¸çµæ´»
```
/\*\*
 \* @returns \[1\]: Location, \[2\]: Customer, \[3\]: Incident
 \*/
Object\[\] getDetails(int id) {...
```
å³ä½¿æœ‰æ–‡æ¡£è®°å½•ï¼Œè¿™ç§ä»æ–¹æ³•ä¼ å›å€¼çš„æ–¹æ³•ä¹Ÿæ˜¯ä¸‘é™‹ä¸”å®¹æ˜“å‡ºé”™çš„ã€‚æ‚¨åº”è¯¥çœŸæ­£å£°æ˜ä¸€ä¸ªå°†å¯¹è±¡ç»“åˆåœ¨ä¸€èµ·çš„å°ç±»ã€‚è¿™ç±»ä¼¼äº`struct`Cä¸­çš„a ã€‚
```
Details getDetails(int id) {...}

private class Details {
    public Location location;
    public Customer customer;
    public Incident incident;
}
```
### ç‰©ä½“è¿‡æ—©åˆ†è§£
```
public void notify(Person p) {
    ...
    sendMail(p.getName(), p.getFirstName(), p.getEmail());
    ...
}

class PhoneBook {
    String lookup(String employeeId) {
        Employee emp = ...
        return emp.getPhone();
    }
}
```
åœ¨ç¬¬ä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œåˆ†è§£å¯¹è±¡åªæ˜¯å°†å…¶çŠ¶æ€ä¼ é€’ç»™æ–¹æ³•æ˜¯å¾ˆç—›è‹¦çš„ã€‚åœ¨ç¬¬äºŒä¸ªç¤ºä¾‹ä¸­ï¼Œæ­¤æ–¹æ³•çš„ä½¿ç”¨éå¸¸æœ‰é™ã€‚å¦‚æœæ€»ä½“è®¾è®¡å…è®¸ï¼Œå®ƒå¯ä»¥é€šè¿‡å¯¹è±¡æœ¬èº«ã€‚
```
public void notify(Person p) {
    ...
    sendMail(p);
    ...
}

class EmployeeDirectory {
    Employee lookup(String employeeId) {
        Employee emp = ...
        return emp;
    }
}
```
### ä¿®æ”¹äºŒä¼ æ‰‹
```
private String name;

public void setName(String name) {
    this.name = name.trim();
}

public void String getName() {
    return this.name;
}
```
è¿™ä¸ªå¯æ€œçš„å¼€å‘äººå‘˜åœ¨ç”¨æˆ·è¾“å…¥çš„åç§°çš„å¼€å¤´æˆ–ç»“å°¾å‡ºç°ç©ºæ ¼ã€‚ä»–è®¤ä¸ºè‡ªå·±å¾ˆèªæ˜ï¼Œåªæ˜¯åˆ é™¤äº†beançš„setteræ–¹æ³•å†…éƒ¨çš„ç©ºæ ¼ã€‚ä½†æ˜¯ï¼Œä¸€ä¸ªä¿®æ”¹æ•°æ®è€Œä¸åªæ˜¯ä¿å­˜æ•°æ®çš„beanæœ‰å¤šå¥‡æ€ªï¼Ÿç°åœ¨ï¼Œgetterè¿”å›çš„æ•°æ®ä¸setterè®¾ç½®çš„æ•°æ®ä¸åŒï¼å¦‚æœè¿™æ˜¯åœ¨EJB3å®ä½“Beanä¸­å®Œæˆçš„ï¼Œåˆ™ä»æ•°æ®åº“ä¸­è¿›è¡Œç®€å•çš„è¯»å–å®é™…ä¸Šä¼šä¿®æ”¹æ•°æ®ï¼šå¯¹äºæ¯ä¸ªINSERTï¼Œå°†æœ‰ä¸€ä¸ªUPDATEè¯­å¥ã€‚æ›´ä¸ç”¨è¯´è°ƒè¯•è¿™äº›å‰¯ä½œç”¨æœ‰å¤šå›°éš¾äº†ï¼é€šå¸¸ï¼Œbeanä¸åº”ä¿®æ”¹å…¶æ•°æ®ã€‚å®ƒæ˜¯ä¸€ä¸ªæ•°æ®å®¹å™¨ï¼Œè€Œä¸æ˜¯ä¸šåŠ¡é€»è¾‘ã€‚åœ¨æœ‰æ„ä¹‰çš„åœ°æ–¹è¿›è¡Œå¾®è°ƒï¼šåœ¨å‘ç”Ÿè¾“å…¥çš„æ§åˆ¶å™¨ä¸­æˆ–åœ¨ä¸éœ€è¦ç©ºæ ¼çš„é€»è¾‘ä¸­ã€‚
```
person.setName(textInput.getText().trim());
```
### ä¸å¿…è¦çš„æ—¥å†
```
Calendar cal = new GregorianCalender(TimeZone.getTimeZone("Europe/Zurich"));
cal.setTime(date);
cal.add(Calendar.HOUR\_OF\_DAY, 8);
date = cal.getTime();
```
å¼€å‘äººå‘˜çš„ä¸€ä¸ªå…¸å‹é”™è¯¯ï¼Œä»–ä»¬å¯¹æ—¥æœŸï¼Œæ—¶é—´ï¼Œæ—¥å†å’Œæ—¶åŒºæ„Ÿåˆ°å›°æƒ‘ã€‚è¦å°†8å°æ—¶æ·»åŠ åˆ°æ—¥æœŸï¼Œåˆ™ä¸éœ€è¦æ—¥å†ã€‚ä»»ä½•ç›¸å…³çš„æ—¶åŒºä¹Ÿä¸æ˜¯ã€‚ï¼ˆæƒ³æƒ³å¦‚æœæ‚¨ä¸ç†è§£è¿™ä¸€ç‚¹ï¼ï¼‰ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å¢åŠ å¤©æ•°ï¼ˆè€Œä¸æ˜¯å°æ—¶æ•°ï¼‰ï¼Œæˆ‘ä»¬å°†éœ€è¦ä¸€ä¸ªæ—¥å†ï¼Œå› ä¸ºæˆ‘ä»¬ä¸ç¡®å®šä¸€å¤©çš„æ—¶é•¿ï¼ˆåœ¨DSTæ›´æ”¹çš„æ—¥å­ï¼Œå¯èƒ½ä¼šæœ‰23æˆ–25å°æ—¶ï¼‰ã€‚
```
date = new Date(date.getTime() + 8L \* 3600L \* 1000L); // add 8 hrs

Calendar cal = new GregorianCalender(TimeZone.getTimeZone("Europe/Zurich"));
SimpleDateFormat df = new SimpleDateFormat("dd.MM.yyyy HH:mm");
df.setCalendar(cal);
```
åœ¨è¿™é‡Œï¼ŒCalendarå¯¹è±¡æ˜¯å®Œå…¨ä¸å¿…è¦çš„ã€‚DateFormatå¯¹è±¡å·²ç»åŒ…å«ä¸€ä¸ªCalendarå®ä¾‹ã€‚å†ç”¨ä¸€æ¬¡ã€‚
```
SimpleDateFormat df = new SimpleDateFormat("dd.MM.yyyy HH:mm");
df.setTimeZone(TimeZone.getTimeZone("Europe/Zurich"));
```
### ä¾èµ–é»˜è®¤çš„æ—¶åŒº
```
Calendar cal = new GregorianCalendar();
cal.setTime(date);
cal.set(Calendar.HOUR\_OF\_DAY, 0);
cal.set(Calendar.MINUTE, 0);
cal.set(Calendar.SECOND, 0);
Date startOfDay = cal.getTime();
```
å¼€å‘äººå‘˜æƒ³è¦è®¡ç®—ä¸€å¤©çš„å¼€å§‹æ—¶é—´ï¼ˆ0h00ï¼‰ã€‚é¦–å…ˆï¼Œä»–æ˜¾ç„¶é”™è¿‡äº†æ—¥å†çš„æ¯«ç§’å­—æ®µã€‚ä½†æ˜¯ï¼ŒçœŸæ­£çš„å¤§é”™è¯¯ä¸æ˜¯è®¾ç½®Calendarå¯¹è±¡çš„TimeZoneã€‚æ—¥å†å°†å› æ­¤ä½¿ç”¨é»˜è®¤æ—¶åŒºã€‚åœ¨æ¡Œé¢åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™å¯èƒ½å¾ˆå¥½ï¼Œä½†æ˜¯åœ¨æœåŠ¡å™¨ç«¯ä»£ç ä¸­ï¼Œè¿™å‡ ä¹ä¸æ˜¯æ‚¨æƒ³è¦çš„ï¼šåœ¨ä¸Šæµ·ï¼Œä¸ä¼¦æ•¦ç›¸æ¯”ï¼Œ0h00çš„æ—¶åˆ»ä¸ç°åœ¨æˆªç„¶ä¸åŒã€‚å¼€å‘äººå‘˜éœ€è¦æ£€æŸ¥å“ªä¸ªæ—¶åŒºä¸æ­¤è®¡ç®—ç›¸å…³ã€‚
```
Calendar cal = new GregorianCalendar(user.getTimeZone());
cal.setTime(date);
cal.set(Calendar.HOUR\_OF\_DAY, 0);
cal.set(Calendar.MINUTE, 0);
cal.set(Calendar.SECOND, 0);
cal.set(Calendar.MILLISECOND, 0);
Date startOfDay = cal.getTime();
```
### æ—¶åŒºâ€œè½¬æ¢â€
```
public static Date convertTz(Date date, TimeZone tz) {
  Calendar cal = Calendar.getInstance();
  cal.setTimeZone(TimeZone.getTimeZone("UTC"));
  cal.setTime(date);
  cal.setTimeZone(tz);
  return cal.getTime();
}
```
å¦‚æœæ‚¨è®¤ä¸ºæ­¤æ–¹æ³•æœ‰å¸®åŠ©ï¼Œè¯·é˜…è¯»[æœ‰å…³time](datetime.php)çš„ [æ–‡ç« ](datetime.php)ã€‚è¯¥å¼€å‘äººå‘˜å°šæœªé˜…è¯»æœ¬æ–‡ï¼Œå¹¶æ‹¼å‘½å°è¯•â€œå›ºå®šâ€å…¶çº¦ä¼šçš„æ—¶åŒºã€‚å®é™…ä¸Šï¼Œè¯¥æ–¹æ³•ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚è¿”å›çš„æ—¥æœŸå°†ä¸è¾“å…¥æ²¡æœ‰ä»»ä½•ä¸åŒçš„å€¼ã€‚å› ä¸ºæ—¥æœŸä¸åŒ…å«æ—¶åŒºä¿¡æ¯ã€‚å®ƒå§‹ç»ˆæ˜¯UTCã€‚Calendarçš„getTime / setTimeæ–¹æ³•å§‹ç»ˆåœ¨UTCä¸Calendarçš„å®é™…æ—¶åŒºä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚

### ä½¿ç”¨Calendar.getInstanceï¼ˆï¼‰
```
Calendar c = Calendar.getInstance();
c.set(2009, Calendar.JANUARY, 15);
```
æ­¤ä»£ç å‡å®šä½¿ç”¨å…¬å†ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¿”å›çš„Calendarå­ç±»æ˜¯ä½›æ•™ï¼Œå„’ç•¥ï¼Œå¸Œä¼¯æ¥è¯­ï¼Œä¼Šæ–¯å…°ï¼Œä¼Šæœ—æˆ–Discordianæ—¥å†ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿåœ¨è¿™äº›å¹´ä»½ä¸­ï¼Œ2009å¹´å…·æœ‰éå¸¸ä¸åŒçš„å«ä¹‰ã€‚è€Œä¸”ä¸€ä¸ªæœˆç§°ä¸ºä¸€æœˆä¸å­˜åœ¨ã€‚Calendar.getInstanceï¼ˆï¼‰ä½¿ç”¨å½“å‰çš„é»˜è®¤è¯­è¨€ç¯å¢ƒé€‰æ‹©é€‚å½“çš„å®ç°ã€‚è¿™å–å†³äºå¯ç”¨çš„Javaå®ç°ã€‚å› æ­¤Calendar.getInstanceï¼ˆï¼‰çš„å®ç”¨ç¨‹åºéå¸¸æœ‰é™ï¼Œåº”é¿å…ä½¿ç”¨å®ƒï¼Œå› ä¸ºå…¶ç»“æœå®šä¹‰ä¸æ˜ç¡®ã€‚
```
Calendar c = new GregorianCalendar(timeZone);
c.set(2009, Calendar.JANUARY, 15);
```
### å±é™©æ—¥å†æ“ä½œ
```
GregorianCalender cal = new GregorianCalender(TimeZone.getTimeZone("Europe/Zurich"));
cal.set(Calendar.SECOND, 0);
cal.set(Calendar.MILLISECOND, 0);
if (cal.before(other)) doSomething();

cal.setTimeZone(TimeZone.getTimeZone("GMT"));
cal.set(Calendar.HOUR\_OF\_DAY, 23);
Date d = cal.getTime();
```
æ­¤ä»£ç ä»¥ä¸€å®šæ–¹å¼å¤„ç†Calendarå¯¹è±¡ï¼Œè¿™äº›æ–¹æ³•å¿…ç„¶ä¼šäº§ç”Ÿæœªå®šä¹‰çš„ç»“æœã€‚æ—¥å†å¯¹è±¡å…·æœ‰å¤æ‚çš„å†…éƒ¨çŠ¶æ€ï¼šæ—¥æœŸï¼Œå°æ—¶ï¼Œå¹´ç­‰çš„å„ä¸ªå­—æ®µï¼Œå†å…ƒå€¼ï¼ˆå¦‚æ—¥æœŸï¼‰åçš„æ¯«ç§’æ•°å’Œæ—¶åŒºã€‚æ ¹æ®æ‚¨æ‰€åšçš„æ›´æ”¹ï¼Œè¿™äº›å­—æ®µä¸­çš„æŸäº›æ˜¯æ— æ•ˆçš„ï¼Œå¹¶ä¸”ä»…å½“æ‚¨è°ƒç”¨æŸäº›æ–¹æ³•æ—¶æ‰ä»å…¶ä»–å€¼é‡æ–°è®¡ç®—ï¼š

*   `set()` è‡ªå†å…ƒå€¼å’Œç›¸å…³å­—æ®µä»¥æ¥çš„æ¯«ç§’æ•°æ— æ•ˆï¼ˆæ›´æ”¹DATEæ˜¾ç„¶ä¼šä½¿DAY\_OF\_WEEKæ— æ•ˆï¼‰
*   `setTimeZone()` ä½¿æ‰€æœ‰å­—æ®µå‡æ— æ•ˆï¼Œä»çºªå…ƒå€¼å¼€å§‹æ‰§è¡Œçš„æ¯«ç§’æ•°
*   `get(), getTime(), getTimeInMillis(), add(), roll()` ä»å­—æ®µé‡æ–°è®¡ç®—è‡ªçºªå…ƒä»¥æ¥çš„æ¯«ç§’æ•°
*   `get(), add()` è¿˜ä¼šé‡æ–°è®¡ç®—è‡ªçºªå…ƒä»¥æ¥çš„æ¯«ç§’æ•°å†…çš„æ— æ•ˆå­—æ®µ

å½“æ‚¨æ›´æ”¹ä¸å­—æ®µ`set()`ï¼Œç„¶ådependendé¢†åŸŸæ²¡æœ‰å¾—åˆ°æ›´æ–°ï¼Œç›´åˆ°ä½ æ‰“ç”µè¯ `get()`ï¼Œ`getTime()`ï¼Œ`getTimeInMillis()`ï¼Œ`add()`ï¼Œæˆ–`roll()`ã€‚ä¸Šé¢ä»£ç è°ƒç”¨çš„ç¬¬ä¸€æ®µï¼Œ`set()`åè·Ÿ`before()`ã€‚æ ¹æ®APIæ–‡æ¡£ï¼Œä¸èƒ½ä¿è¯beforeï¼ˆï¼‰ä¼šçœ‹åˆ°ä¿®æ”¹åçš„æ—¶é—´å€¼ã€‚

ç¬¬äºŒæ®µé€šè¿‡è°ƒç”¨`setTimeZone()` å’Œ`set()`ï¼Œä½¿å†å…ƒå€¼åçš„æ‰€æœ‰å­—æ®µå’Œæ¯«ç§’æ— æ•ˆï¼Œä»è€Œå®Œå…¨ä¸¢å¤±æ—¥å†çš„æ•°æ®ã€‚å¦è¯·å‚è§[é”™è¯¯4827490](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4827490)

æ—¥å†å¯¹è±¡åº”å§‹ç»ˆæ ¹æ®ä»¥ä¸‹ç®€å•è§„åˆ™è¿›è¡Œæ“ä½œï¼š

*   åœ¨æ„é€ å‡½æ•°ä¸­å·²ç»åˆå§‹åŒ–äº†TimeZoneï¼ˆå¦‚æœéœ€è¦ï¼Œè¿˜å¯ä»¥åˆå§‹åŒ–Localeï¼‰
*   é€šè¯åå°†é€šè¯`set()`æ·»åŠ åˆ°`getTimeInMillis()`
*   é€šè¯åå°†é€šè¯`setTimeZone()`æ·»åŠ åˆ°`get()`
```
GregorianCalender cal = new GregorianCalender(TimeZone.getTimeZone("Europe/Zurich"));
cal.set(Calendar.SECOND, 0);
cal.set(Calendar.MILLISECOND, 0);
cal.getTimeInMillis();
if (cal.before(other)) doSomething();

cal.setTimeZone(TimeZone.getTimeZone("GMT"));
cal.get(Calendar.DATE);
cal.set(Calendar.HOUR\_OF\_DAY, 23);
Date d = cal.getTime();
```
### è°ƒç”¨Date.setTimeï¼ˆï¼‰
```
account.changePassword(oldPass, newPass);
Date lastmod = account.getLastModified();
lastmod.setTime(System.currentTimeMillis());
```
ä¸Šé¢çš„ä»£ç æ›´æ–°äº†å¸æˆ·å®ä½“çš„æœ€åä¿®æ”¹æ—¥æœŸã€‚ç¨‹åºå‘˜å¸Œæœ›ä¿æŒä¿å®ˆï¼Œå¹¶é¿å…åˆ›å»ºæ–°`Date`å¯¹è±¡ã€‚ç›¸åï¼Œå¥¹ä½¿ç”¨çš„ `setTime`æ–¹æ³•æ¥ä¿®æ”¹ç°æœ‰`Date`å®ä¾‹ã€‚

å®é™…ä¸Šï¼Œè¿™æ²¡æœ‰é”™ã€‚ä½†æˆ‘åªæ˜¯ä¸æ¨èè¿™ç§åšæ³•ã€‚æ—¥æœŸå¯¹è±¡é€šå¸¸ä¼šç²—å¿ƒä¼ é€’ã€‚å¯ä»¥å°†åŒä¸€Dateå®ä¾‹ä¼ é€’ç»™è®¸å¤šå¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡ä¸ä¼šåœ¨å…¶è®¾ç½®å™¨ä¸­è¿›è¡Œå¤åˆ¶ã€‚æ—¥æœŸé€šå¸¸åƒå›¾å…ƒä¸€æ ·ä½¿ç”¨ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨ä¿®æ”¹Dateå®ä¾‹ï¼Œåˆ™ä½¿ç”¨è¯¥å®ä¾‹çš„å…¶ä»–å¯¹è±¡å¯èƒ½ä¼šå‡ºç°å¼‚å¸¸æƒ…å†µã€‚å½“ç„¶ï¼Œå¦‚æœæ‚¨ç¼–å†™çš„ä»£ç ä¸¥æ ¼éµå¾ªç»å…¸çš„OOåŸç†ï¼ˆæˆ‘è®¤ä¸ºè¿™å¾ˆä¸æ–¹ä¾¿ï¼‰ï¼Œé‚£ä¹ˆå¦‚æœå¯¹è±¡å°†å…¶å›ºæœ‰çš„Dateå®ä¾‹æš´éœ²ç»™å¤–ç•Œï¼Œé‚£å°†æ˜¯ä¸å¹²å‡€çš„è®¾è®¡ã€‚ä½†æ˜¯ï¼Œå¸¸è§„çš„æ—¥å¸¸Javaåšæ³•æ˜¯ä»…å¤åˆ¶Dateå¼•ç”¨ï¼Œè€Œä¸ç”¨setterå…‹éš†å¯¹è±¡ã€‚å› æ­¤ï¼Œæ¯ä¸ªç¨‹åºå‘˜éƒ½åº”å°†Dateè§†ä¸ºä¸å¯å˜çš„ï¼Œå¹¶ä¸”ä¸åº”ä¿®æ”¹ç°æœ‰å®ä¾‹ã€‚ä»…å‡ºäºç‰¹æ®Šæƒ…å†µä¸‹çš„æ€§èƒ½åŸå› ï¼Œæ‰åº”è¿™æ ·åšã€‚å³ä½¿é‚£æ ·ç®€å•çš„ä½¿ç”¨`long` å¯èƒ½åŒæ ·å¥½ã€‚
```
account.changePassword(oldPass, newPass);
account.setLastModified(new Date());
```
### å‡è®¾SimpleDateFormatæ˜¯çº¿ç¨‹å®‰å…¨çš„
```
public class Constants {
    public static final SimpleDateFormat date = new SimpleDateFormat("dd.MM.yyyy");
}
```
ä¸Šé¢çš„ä»£ç æœ‰å‡ ç§ç¼ºé™·ã€‚åäº†ï¼Œå› ä¸ºå®ƒä¸ä»»ä½•æ•°é‡çš„çº¿ç¨‹å…±äº«ä¸€ä¸ªSimpleDateFormatçš„é™æ€å®ä¾‹ã€‚SimpleDateFormatä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶ä½¿ç”¨æ­¤å¯¹è±¡ï¼Œåˆ™ç»“æœæ˜¯ä¸ç¡®å®šçš„ã€‚æ‚¨å¯èƒ½ä¼šå‘ç°ä»è¾“å‡ºé™Œç”Ÿ`format`å’Œ`parse`ç”šè‡³ä¾‹å¤–ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸ªé”™è¯¯å¾ˆå¸¸è§ï¼

æ˜¯çš„ï¼Œå…±äº«SimpleDateFormatéœ€è¦æ­£ç¡®çš„åŒæ­¥ã€‚æ˜¯çš„ï¼Œéœ€è¦ä»˜å‡ºä¸€å®šçš„ä»£ä»·ï¼ˆç¼“å­˜åˆ·æ–°ï¼Œé”äº‰ç”¨ç­‰ï¼‰ã€‚æ˜¯çš„ï¼Œåˆ›å»ºSimpleDateFormatä¹Ÿä¸æ˜¯å…è´¹çš„ï¼ˆæ¨¡å¼è§£æï¼Œå¯¹è±¡åˆ†é…ï¼‰ã€‚ä½†æ˜¯ï¼Œç®€å•åœ°å¿½ç•¥çº¿ç¨‹å®‰å…¨æ€§ä¸æ˜¯è§£å†³æ–¹æ¡ˆï¼Œè€Œæ˜¯ç ´è§£ä»£ç çš„è‚¯å®šæ–¹æ³•ã€‚

å½“ç„¶ï¼Œæ­¤ä»£ç ä¹Ÿæ²¡æœ‰è€ƒè™‘æ—¶åŒºã€‚ç„¶åå®šä¹‰ä¸€ä¸ªåä¸ºâ€œ Constantsâ€çš„ç±»ï¼Œå®ƒå‘å‡ºå¦ä¸€ä¸ªåæ¨¡å¼çš„å°–å«ï¼ˆè¯·å‚é˜…ä¸‹ä¸€èŠ‚ï¼‰ã€‚

### å…·æœ‰å…¨å±€Configuration / Parameters / Constantsç±»
```
public interface Constants {
    String version = "1.0";
    String dateFormat = "dd.MM.yyyy";
    String configFile = ".apprc";
    int maxNameLength = 32;
    String someQuery = "SELECT \* FROM ...";
}
```
åœ¨å¤§å‹é¡¹ç›®ä¸­ç»å¸¸è§åˆ°ï¼šä¸€ä¸ªç±»æˆ–æ¥å£ï¼ŒåŒ…å«åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„å„ç§å¸¸é‡ã€‚ä¸ºä»€ä¹ˆè¿™æ ·ä¸å¥½ï¼Ÿå› ä¸ºè¿™äº›å¸¸é‡å½¼æ­¤æ— å…³ã€‚æ­¤ç±»æ˜¯ä»–ä»¬å”¯ä¸€çš„å…±åŒç‚¹ã€‚å¯¹è¯¥ç±»çš„å¼•ç”¨å°†å†æ¬¡æ±¡æŸ“åº”ç”¨ç¨‹åºçš„è®¸å¤šä¸ç›¸å…³ç»„ä»¶ã€‚æ‚¨è¦ç¨åæå–ä¸€ä¸ªç»„ä»¶å¹¶åœ¨å…¶ä»–åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨å®ƒå—ï¼Ÿè¿˜æ˜¯åœ¨æœåŠ¡å™¨å’Œè¿œç¨‹å®¢æˆ·ç«¯ä¹‹é—´å…±äº«ä¸€äº›ç±»ï¼Ÿæ‚¨å¯èƒ½è¿˜éœ€è¦æä¾›å¸¸é‡ç±»ï¼æ­¤ç±»åœ¨å…¶ä»–ä¸ç›¸å…³çš„ç»„ä»¶ä¹‹é—´å¼•å…¥äº†ä¾èµ–å…³ç³»ã€‚è¿™æŠ‘åˆ¶äº†é‡ç”¨å’Œæ¾è€¦åˆï¼Œå¹¶è®©æ··ä¹±ã€‚

è€Œæ˜¯å°†å¸¸é‡æ”¾åœ¨å®ƒä»¬æ‰€å±çš„ä½ç½®ã€‚åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œå‡ä¸å¾—è·¨ç»„ä»¶è¾¹ç•Œä½¿ç”¨å¸¸é‡ã€‚ä»…å½“ç»„ä»¶æ˜¯éœ€è¦æ˜¾å¼ä¾èµ–çš„åº“æ—¶æ‰å…è®¸è¿™æ ·åšã€‚

### æ²¡æœ‰æ³¨æ„åˆ°æº¢å‡º
```
public int getFileSize(File f) {
  long l = f.length();
  return (int) l;
}
```
æ— è®ºå‡ºäºä½•ç§åŸå› ï¼Œè¯¥å¼€å‘äººå‘˜éƒ½å°†ç¡®å®šæ–‡ä»¶å¤§å°çš„è°ƒç”¨åŒ…è£…åˆ°è¿”å›`int`è€Œä¸æ˜¯çš„æ–¹æ³•ä¸­`long`ã€‚æ­¤ä»£ç ä¸æ”¯æŒå¤§äº2 GBçš„æ–‡ä»¶ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹åªä¼šè¿”å›é”™è¯¯çš„é•¿åº¦ã€‚å°†å€¼å¼ºåˆ¶è½¬æ¢ä¸ºè¾ƒå°å¤§å°ç±»å‹çš„ä»£ç å¿…é¡»é¦–å…ˆæ£€æŸ¥å¯èƒ½çš„æº¢å‡ºå¹¶å¼•å‘å¼‚å¸¸ã€‚
```
public int getFileSize(File f) {
  long l = f.length();
  if (l > Integer.MAX\_VALUE) throw new IllegalStateException("int overflow");
  return (int) l;
}
```
ä»¥ä¸‹æ˜¯æº¢å‡ºé”™è¯¯çš„å¦ä¸€ä¸ªç‰ˆæœ¬ã€‚è¯·æ³¨æ„ç¬¬ä¸€ä¸ªprintlnè¯­å¥ä¸­ç¼ºå°‘çš„æ‹¬å·ã€‚
```
long a = System.currentTimeMillis();
long b = a + 100;
System.out.println((int) b-a);
System.out.println((int) (b-a)); 
```
æœ€åï¼Œæ˜¯æˆ‘åœ¨ä»£ç å®¡æŸ¥è¿‡ç¨‹ä¸­è¿æ ¹æ‹”èµ·çš„çœŸæ­£ç‘°å®ã€‚è¯·æ³¨æ„ç¨‹åºå‘˜æ˜¯å¦‚ä½•å°è¯•å°å¿ƒçš„ï¼Œä½†éšåç”±äºå‡è®¾ä¸€ä¸ªintå¯èƒ½å˜å¾—å¤§äºå…¶æœ€å¤§å€¼è€Œä¸¥é‡å¤±è´¥ã€‚
```
int a = l.size();
a = a + 100;
if (a > Integer.MAX\_VALUE)
    throw new ArithmeticException("int overflow");
```
### å°†==ä¸floatæˆ–doubleä¸€èµ·ä½¿ç”¨
```
for (float f = 10f; f!=0; f-=0.1) {
  System.out.println(f);
}
```
ä¸Šé¢çš„ä»£ç æ— æ³•æ­£å¸¸å·¥ä½œã€‚å®ƒå¯¼è‡´æ— é™å¾ªç¯ã€‚å› ä¸º0.1æ˜¯ä¸€ä¸ª [æ— é™çš„äºŒè¿›åˆ¶åè¿›åˆ¶æ•°](http://www.binaryconvert.com/result_float.html?decimal=048046049)ï¼Œæ‰€ä»¥`f`æ°¸è¿œä¸ä¼šå®Œå…¨ä¸º0ã€‚é€šå¸¸ï¼Œæ‚¨æ°¸è¿œä¸è¦å°†æµ®ç‚¹æˆ–åŒç²¾åº¦å€¼ä¸ç›¸ç­‰è¿ç®—ç¬¦==è¿›è¡Œæ¯”è¾ƒã€‚å§‹ç»ˆä½¿ç”¨å°äºæˆ–å¤§äºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåº”æ›´æ”¹Javaç¼–è¯‘å™¨ä»¥å‘å‡ºè­¦å‘Šã€‚ç”šè‡³ä½¿Javaè¯­è¨€è§„èŒƒä¸­çš„æµ®ç‚¹ç±»å‹çš„==éæ³•æ“ä½œæˆä¸ºå¯èƒ½ã€‚æ‹¥æœ‰æ­¤åŠŸèƒ½çœŸçš„æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚
```
for (float f = 10f; f>0; f-=0.1) {
  System.out.println(f);
}
```
### å°†é’±å­˜å…¥æµ®ç‚¹å˜é‡
```
float total = 0.0f;
for (OrderLine line : lines) {
  total += line.price \* line.count;
}

double a = 1.14 \* 75; // 85.5 represented as 85.4999...
System.out.println(Math.round(a)); // surprising output: 85
System.out.println(10.0/3); // surprising output: 3.333333333333333**5** (precision lost twice during division and on conversion to decimal)

BigDecimal d = new BigDecimal(1.14); // precision has already been lost
```
æˆ‘å·²ç»çœ‹åˆ°è®¸å¤šå¼€å‘äººå‘˜ç¼–å†™äº†è¿™æ ·çš„å¾ªç¯ã€‚åŒ…æ‹¬æˆ‘æ—©å¹´çš„æˆ‘è‡ªå·±ã€‚å½“æ­¤ä»£ç å°†100æ¡è®¢å•è¡Œç›¸åŠ ï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ª0.30 $é¡¹æ—¶ï¼Œå¾—å‡ºçš„æ€»å’Œå°†ç²¾ç¡®è®¡ç®—ä¸º29.999971ã€‚å¼€å‘äººå‘˜æ³¨æ„åˆ°å¼‚å¸¸è¡Œä¸ºï¼Œå¹¶å°†floatæ›´æ”¹ä¸ºæ›´ç²¾ç¡®çš„doubleå€¼ï¼Œä»…å¾—åˆ°ç»“æœ30.000001192092896ã€‚å½“ç„¶ï¼Œç”±äºäººï¼ˆåè¿›åˆ¶æ ¼å¼ï¼‰å’Œè®¡ç®—æœºï¼ˆäºŒè¿›åˆ¶æ ¼å¼ï¼‰åœ¨æ•°å­—è¡¨ç¤ºä¸Šçš„å·®å¼‚ï¼Œæœ‰äº›ä»¤äººæƒŠè®¶çš„ç»“æœã€‚å½“æ‚¨å¢åŠ é›¶ç”¨é’±æˆ–è®¡ç®—å¢å€¼ç¨æ—¶ï¼Œå®ƒæ€»æ˜¯ä»¥å…¶æœ€ä»¤äººè®¨åŒçš„å½¢å¼å‡ºç°ã€‚

å¯¹äºå›ºæœ‰çš„_ä¸ç²¾ç¡®_ å€¼ï¼ˆä¾‹å¦‚æµ‹é‡å€¼ï¼‰ï¼Œå‘æ˜äº†æµ®ç‚¹æ•°çš„äºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼ã€‚å®Œç¾çš„å·¥ç¨‹ï¼ä½†æ˜¯å½“æ‚¨éœ€è¦ç²¾ç¡®çš„æ•°å­¦è¿ç®—æ—¶æ— æ³•ä½¿ç”¨ã€‚åƒé“¶è¡Œã€‚æˆ–æ•°æ•°æ—¶ã€‚

åœ¨æŸäº›ä¸šåŠ¡æ¡ˆä¾‹ä¸­ï¼Œæ‚¨ä¸èƒ½å¤±å»ç²¾ç¡®åº¦ã€‚åœ¨åè¿›åˆ¶å’ŒäºŒè¿›åˆ¶ä¹‹é—´è¿›è¡Œè½¬æ¢æ—¶ï¼Œä»¥åŠåœ¨èˆå…¥æ–¹å¼ä¸æ˜ç¡®æˆ–ä¸æ˜ç¡®çš„ç‚¹ä¸Šè¿›è¡Œèˆå…¥æ—¶ï¼Œæ‚¨å°†å¤±å»ç²¾åº¦ã€‚ä¸ºäº†é¿å…ç²¾åº¦ä¸‹é™ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨å®šç‚¹æˆ–æ•´æ•°è¿ç®—ã€‚è¿™ä¸ä»…é€‚ç”¨äºè´§å¸ä»·å€¼ï¼Œè€Œä¸”åœ¨ä¸šåŠ¡åº”ç”¨ç¨‹åºä¸­ç»å¸¸å¼•èµ·çƒ¦æ¼ï¼Œå› æ­¤æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚åœ¨ç¬¬äºŒä¸ªç¤ºä¾‹ä¸­ï¼Œç¨‹åºçš„ä¸€ä¸ªæ¯«æ— æˆ’å¿ƒçš„ç”¨æˆ·åªä¼šè¯´è®¡ç®—æœºçš„è®¡ç®—å™¨åäº†ã€‚å¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼Œè¿™å½“ç„¶æ˜¯å¾ˆå°´å°¬çš„ã€‚

å› æ­¤ï¼Œ_æ°¸è¿œä¸è¦_ä»¥æµ®ç‚¹æ•°æ®ç±»å‹ï¼ˆæµ®ç‚¹æ•°ï¼ŒåŒç²¾åº¦æ•°ï¼‰å­˜å‚¨é‡‘é¢ã€‚è¯·æ³¨æ„ï¼Œä¸ä»…ä»»ä½•è®¡ç®—éƒ½æ˜¯ä¸ç²¾ç¡®çš„ã€‚å³ä½¿æ˜¯ç®€å•çš„æ•´æ•°ä¹˜æ³•ä¹Ÿå¯èƒ½äº§ç”Ÿä¸ç²¾ç¡®çš„ç»“æœã€‚ä»…ä»¥äºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼ï¼ˆæµ®ç‚¹æ•°ï¼ŒåŒç²¾åº¦ï¼‰_å­˜å‚¨_å€¼çš„äº‹å® å¯èƒ½å·²ç»å¯¼è‡´äº†èˆå…¥ï¼ _æ‚¨æ ¹æœ¬æ— æ³•å°†0.3ä½œä¸ºç²¾ç¡®å€¼å­˜å‚¨åœ¨floatæˆ–doubleä¸­_ã€‚å› ä¸ºfloatå’Œdoubleæ˜¯[äºŒè¿›åˆ¶IEEE754](http://en.wikipedia.org/wiki/Binary64)ç±»å‹ã€‚å¦è¯·å‚é˜…[æ­¤å¤„](http://0.30000000000000004.com/)ã€‚æ‚¨å¯ä»¥åœ¨[æ­¤å¤„å°è¯•](http://www.binaryconvert.com/result_float.html?decimal=049046049052)å„ç§æ•°å­—åŠå…¶ [äºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼](http://www.binaryconvert.com/result_float.html?decimal=049046049052)ã€‚å¦‚æœæ‚¨åœ¨è´¢åŠ¡ä»£ç åº“ä¸­çœ‹åˆ°æµ®åŠ¨æˆ–åŒç²¾åº¦ï¼Œåˆ™è¯¥ä»£ç å¾ˆå¯èƒ½ä¼šäº§ç”Ÿä¸ç²¾ç¡®çš„ç»“æœã€‚ç›¸åï¼Œåº”è¯¥é€‰æ‹©å­—ç¬¦ä¸²æˆ–å®šç‚¹è¡¨ç¤ºå½¢å¼ã€‚æ–‡æœ¬è¡¨ç¤ºå½¢å¼å¿…é¡»é‡‡ç”¨å®šä¹‰æ˜ç¡®çš„æ ¼å¼ï¼Œå¹¶ä¸”_ä¸å¾—_ä¸åŒºåŸŸè®¾ç½®ç‰¹å®šæ ¼å¼çš„ç”¨æˆ·è¾“å…¥/è¾“å‡ºæ··æ·†ã€‚ä¸¤ç§è¡¨ç¤ºå½¢å¼éƒ½å¿…é¡»å®šä¹‰æ‰€å­˜å‚¨çš„ç²¾åº¦ï¼ˆå°æ•°ç‚¹å‰åçš„ä½æ•°ï¼‰ã€‚

ä¸ºäº†è¿›è¡Œè®¡ç®—ï¼Œ[BigDecimal](http://java.sun.com/j2se/1.5.0/docs/api/java/math/BigDecimal.html)ç±» æä¾›äº†ä¸€ç§å‡ºè‰²çš„å·¥å…·ã€‚å¯ä»¥ä½¿ç”¨è¯¥ç±»ï¼Œä»¥ä¾¿åœ¨æ“ä½œä¸­æ„å¤–ä¸¢å¤±ç²¾åº¦æ—¶å¼•å‘è¿è¡Œæ—¶å¼‚å¸¸ã€‚è¿™å¯¹äºæ¶ˆé™¤ç»†å¾®çš„æ•°å­—é”™è¯¯éå¸¸æœ‰ç”¨ï¼Œå¹¶ä½¿å¼€å‘äººå‘˜å¯ä»¥æ›´æ­£è®¡ç®—ç»“æœã€‚
```
BigDecimal total = BigDecimal.ZERO;
for (OrderLine line : lines) {
  BigDecimal price = new BigDecimal(line.price);
  BigDecimal count = new BigDecimal(line.count);
  total = total.add(price.multiply(count)); // BigDecimal is immutable!
}
total = total.setScale(2, RoundingMode.HALF\_UP);

BigDecimal a = (new BigDecimal("1.14")).multiply(new BigDecimal(75)); // 85.5 exact
a = a.setScale(0, RoundingMode.HALF\_UP); // 86
System.out.println(a); // correct output: 86

BigDecimal a = new BigDecimal("1.14");
```
### åœ¨finallyå—ä¸­ä¸é‡Šæ”¾èµ„æº
```
public void save(File f) throws IOException {
  OutputStream out = new BufferedOutputStream(new FileOutputStream(f));
  out.write(...);
  out.close();
}

public void load(File f) throws IOException {
  InputStream in = new BufferedInputStream(new FileInputStream(f));
  in.read(...);
  in.close();
}
```
ä¸Šé¢çš„ä»£ç æ‰“å¼€è¾“å‡ºæµåˆ°æ–‡ä»¶ï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­åˆ†é…æ–‡ä»¶å¥æŸ„ã€‚æ–‡ä»¶å¥æŸ„æ˜¯ä¸€ç§ç¨€æœ‰èµ„æºï¼Œéœ€è¦é€šè¿‡åœ¨FileOutputStreamä¸Šè°ƒç”¨closeæ¥æ­£ç¡®é‡Šæ”¾ï¼ˆå½“ç„¶ï¼Œä¸FileInputStreamç›¸åŒï¼‰ã€‚ä¸ºäº†ç¡®ä¿å³ä½¿å‘ç”Ÿå¼‚å¸¸ï¼ˆåœ¨å†™æ“ä½œæœŸé—´æ–‡ä»¶ç³»ç»Ÿå¯èƒ½å·²æ»¡ï¼‰ï¼Œä¹Ÿå¿…é¡»åœ¨finallyå—ä¸­è¿›è¡Œå…³é—­ã€‚åœ¨æ­¤ï¼Œæµè¿˜è¢«åŒ…è£…åˆ°ç¼“å†²æµä¸­ã€‚è¿™æ„å‘³ç€åˆ°æˆ‘ä»¬åˆ°è¾¾ç£ç›˜æ—¶ï¼Œå¹¶éæ‰€æœ‰æ•°æ®éƒ½å·²è¢«å†™å…¥ç£ç›˜ã€‚`close()`å‘¼å«ã€‚closeè°ƒç”¨æœ¬èº«ä¼šå°†ç¼“å†²åŒºä¸­çš„å¾…å¤„ç†æ•°æ®åˆ·æ–°åˆ°ç£ç›˜ï¼Œå› æ­¤è‡ªèº«å¯èƒ½ä¼šå¤±è´¥å¹¶å‡ºç°IOExceptionã€‚å¦‚æœå…³é—­å¤±è´¥ï¼Œåˆ™ç£ç›˜ä¸Šçš„æ–‡ä»¶ä¸å®Œæ•´ï¼ˆè¢«æˆªæ–­ï¼‰ï¼Œå› æ­¤å¾ˆå¯èƒ½å·²æŸåã€‚å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥æ–¹æ³•åº”ä¼ æ’­IOExceptionã€‚å¯¹äºFileInputStreamï¼Œæˆ‘ä»¬å¯ä»¥ä»closeï¼ˆï¼‰è°ƒç”¨ä¸­å®‰å…¨åœ°å¿½ç•¥æ½œåœ¨çš„IOExceptionã€‚æˆ‘ä»¬å·²ç»è¯»å–äº†æ‰€éœ€çš„æ‰€æœ‰æ•°æ®ï¼Œå¹¶ä¸”å¦‚æœåº•å±‚çš„closeï¼ˆï¼‰ä»ç„¶å¤±è´¥ï¼Œæˆ‘ä»¬å°†æ— èƒ½ä¸ºåŠ›ã€‚ç”šè‡³ä¸å€¼å¾—è®°å½•å®ƒã€‚

åœ¨ä¸€ä¸ªå®Œç¾çš„ä¸–ç•Œ`BufferedOutputStream.close()`ä¸­å°†æ­£ç¡®å®æ–½ã€‚ä½†æ˜¯å¯æ‚²çš„æ˜¯ï¼Œå®ƒæœ‰ä¸€ä¸ªæ— æ³•[ä¿®å¤çš„é”™è¯¯](http://bugs.sun.com/view_bug.do?bug_id=6335274)ï¼šå®ƒä»éšå¼åˆ·æ–°ä¸­ä¸¢å¤±äº†ä»»ä½•IOExceptionï¼Œå¹¶ä»¥é™é»˜æ–¹å¼æˆªæ–­äº†æ–‡ä»¶ã€‚å› æ­¤ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åœ¨å…³é—­ä¹‹å‰ä½¿ç”¨æ˜¾å¼åˆ·æ–°ç»™å‡ºé€‚å½“çš„è§£å†³æ–¹æ³•ã€‚

ç¡®åˆ‡åœ°è¯´ï¼Œä¸‹é¢çš„æ›´æ­£ä»£ç å¯èƒ½ä¼šåœ¨ä¸€ä¸ªå¾ˆå°çš„æƒ…å†µä¸‹æ³„æ¼ï¼šåˆ†é…æ–‡ä»¶æµä½†éšååˆ†é…ç¼“å†²çš„æµç¥ç§˜åœ°å¤±è´¥ï¼ˆä¾‹å¦‚ï¼Œå†…å­˜ä¸è¶³ï¼‰ã€‚ä½œä¸ºä¸€ä¸ªåŠ¡å®çš„äººï¼Œæˆ‘è®¤ä¸ºåœ¨è¿™ç§ç—…æ€çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å®‰å…¨åœ°ä¾é åƒåœ¾æ”¶é›†å™¨æ¥æ¸…ç†åƒåœ¾ã€‚å¤„ç†å®ƒæ˜¯ä¸å€¼å¾—çš„éº»çƒ¦ã€‚
```
// code for your cookbook
public void save() throws IOException {
  File f = ...
  OutputStream out = new BufferedOutputStream(new FileOutputStream(f));
  try {
    out.write(...);
    out.flush(); // don't lose exception by implicit flush on close
  } finally {
    out.close();
  }
}

public void load(File f) throws IOException {
  InputStream in = new BufferedInputStream(new FileInputStream(f));
  try {
    in.read(...);
  } finally {
    try { in.close(); } catch (IOException e) { }
  }
}
```
è®©æˆ‘ä¹Ÿä¸ºæ‚¨æä¾›å¦ä¸€ç§æ™®éä½¿ç”¨çš„èœè°±ï¼šæ•°æ®åº“è®¿é—®ã€‚åŒæ ·ï¼Œè¿™æ˜¯å®ç”¨çš„æ–¹æ³•ã€‚æ˜¯çš„ï¼Œrs.closeï¼ˆï¼‰å¯èƒ½ä¼šå› ç¥ç§˜çš„é”™è¯¯è€Œå¤±è´¥ï¼Œé™¤éå®ƒä»¬ä»…å‡ºç°åœ¨æ‚¨å…³äºé‡å­åŠ›å­¦çš„å¤§å­¦è®²åº§ä¸­ï¼Œè€Œä¸æ˜¯å‡ºç°åœ¨ã€ŠçœŸå®ä¸–ç•Œã€‹ï¼ˆtmï¼‰ä¸­ã€‚è€Œä¸”åªæœ‰å˜æ€è€…æ‰ä¼šå†™å‡ºå°è¯•/æœ€ç»ˆçº§è”ï¼Œå³æ²¡æœ‰é”™è¯¯ä¸­å¾®å­æ— æ³•é€ƒè„±ã€‚åŸè°…æˆ‘çš„å˜²è®½ã€‚ä¸€åŠ³æ°¸é€¸çš„æ–¹æ³•æ˜¯å¤„ç†SQLå¯¹è±¡ï¼š
```
Car getCar(DataSource ds, String plate) throws SQLException {
  Car car = null;
  Connection c = null;
  PreparedStatement s = null;
  ResultSet rs = null;
  try {
    c = ds.getConnection();
    s = c.prepareStatement("select make, color from cars where plate=?");
    s.setString(1, plate);
    rs = s.executeQuery();
    if (rs.next()) {
       car = new Car();
       car.make = rs.getString(1);
       car.color = rs.getString(2);
    }
  } finally {
    if (rs != null) try { rs.close(); } catch (SQLException e) { }
    if (s != null) try { s.close(); } catch (SQLException e) { }
    if (c != null) try { c.close(); } catch (SQLException e) { }
  }
  return car;
}
```
è¯è™½å¦‚æ­¤ï¼Œä¸è¦é”™è¿‡ä¸‹ä¸€æ®µã€‚

### æ»¥ç”¨finalizeï¼ˆï¼‰
```
public class FileBackedCache {
   private File backingStore;
   
   ...
   
   protected void finalize() throws IOException {
      if (backingStore != null) {
        backingStore.close();
        backingStore = null;
      }
   }
}
```
æ­¤ç±»ä½¿ç”¨è¯¥`finalize`æ–¹æ³•æ¥é‡Šæ”¾æ–‡ä»¶å¥æŸ„ã€‚é—®é¢˜æ˜¯æ‚¨ä¸çŸ¥é“ä½•æ—¶è°ƒç”¨è¯¥æ–¹æ³•ã€‚è¯¥æ–¹æ³•ç”±åƒåœ¾æ”¶é›†å™¨è°ƒç”¨ã€‚å¦‚æœæ‚¨ç”¨å®Œäº†æ–‡ä»¶å¥æŸ„ï¼Œåˆ™å¸Œæœ›æ­¤æ–¹æ³•å°½å¿«è¢«è°ƒç”¨ã€‚ä½†æ˜¯GCå¯èƒ½åªä¼šåœ¨å †å¿«ç”¨å®Œæ—¶æ‰è°ƒç”¨è¯¥æ–¹æ³•ï¼Œè¿™æ˜¯éå¸¸ä¸åŒçš„æƒ…å†µã€‚ä»GCåˆ°å®Œæˆå®šç¨¿ï¼Œå¯èƒ½éœ€è¦å‡ æ¯«ç§’åˆ°å‡ å¤©çš„æ—¶é—´ã€‚åƒåœ¾æ”¶é›†å™¨ä»…ç®¡ç†å†…å­˜ã€‚å®ƒåšå¾—å¾ˆå¥½ã€‚ä½†æ˜¯ï¼Œä¸å¾—æ»¥ç”¨å®ƒæ¥ç®¡ç†é™¤æ­¤ä¹‹å¤–çš„ä»»ä½•å…¶ä»–èµ„æºã€‚**GCä¸æ˜¯é€šç”¨çš„èµ„æºç®¡ç†æœºåˆ¶ï¼**åœ¨è¿™æ–¹é¢ï¼Œæˆ‘å‘ç°Sunçš„finalizeæ–¹æ³•çš„API Docéå¸¸ä»¤äººè¯¯è§£ã€‚å®ƒå®é™…ä¸Šå»ºè®®ä½¿ç”¨æ­¤æ–¹æ³•å…³é—­I / Oèµ„æº-å¦‚æœæ‚¨é—®æˆ‘ï¼Œè¯·å®Œå…¨åºŸè¯ã€‚å†æ¬¡ï¼šI / O ä¸å†…å­˜_æ— å…³_ï¼

æ›´å¥½çš„ä»£ç æä¾›äº†ä¸€ä¸ªå…¬å…±å…³é—­æ–¹æ³•ï¼Œå¿…é¡»ç”±å®šä¹‰è‰¯å¥½çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆä¾‹å¦‚JBoss MBeansï¼‰è°ƒç”¨ã€‚
```
public class FileBackedCache {
   private File backingStore;
   
   ...
   
   public void close() throws IOException {
      if (backingStore != null) {
        backingStore.close();
        backingStore = null;
      }
   }
}
```
JDK 1.7ï¼ˆJava 7ï¼‰å¼•å…¥äº†[AutoClosable](http://download.java.net/jdk7/docs/api/java/lang/AutoCloseable.html)æ¥å£ã€‚`close`å½“å˜é‡ï¼ˆä¸æ˜¯å¯¹è±¡ï¼‰è¶…å‡ºtry-with-resourceå—çš„èŒƒå›´æ—¶ï¼Œå®ƒå¯ç”¨å¯¹æ–¹æ³•çš„è‡ªåŠ¨è°ƒç”¨ã€‚å®ƒä¸ç»ˆç»“å™¨æœ‰å¾ˆå¤§ä¸åŒã€‚å®ƒçš„æ‰§è¡Œæ—¶é—´åœ¨ç¼–è¯‘æ—¶å·²æ˜ç¡®å®šä¹‰ã€‚
```
try (Writer w = new FileWriter(f)) { // implements Closable
  w.write("abc");
  // w goes out of scope here: w.close() is called automatically in ANY case
} catch (IOException e) {
  throw new RuntimeException(e.getMessage(), e);
}
```
### ä¸ç”±è‡ªä¸»åœ°é‡ç½®Thread.interrupted
```
try {
	Thread.sleep(1000);
} catch (InterruptedException e) {
	// ok
}

or 

while (true) {
	if (Thread.interrupted()) break;
}
```
ä¸Šé¢çš„ä»£ç é‡ç½®çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ã€‚éšåçš„è¯»è€…å°†ä¸çŸ¥é“è¯¥çº¿ç¨‹å·²è¢«ä¸­æ–­ã€‚å¦‚æœæ‚¨éœ€è¦ä¼ é€’æœ‰å…³ä¸­æ–­çš„ä¿¡æ¯ï¼Œè¯·åƒè¿™æ ·é‡å†™ä»£ç ã€‚
```
try {
	Thread.sleep(1000);
} catch (InterruptedException e) {
	Thread.currentThread().interrupt();
}

or 

while (true) {
	if (Thread.currentThread().isInterrupted()) break;
}
```
### æ¥è‡ªé™æ€åˆå§‹å€¼è®¾å®šé¡¹çš„ç”Ÿæˆçº¿ç¨‹
```
class Cache {
	private static final Timer evictor = new Timer();
}
```
java.util.Timeråœ¨å…¶æ„é€ å‡½æ•°ä¸­å¢åŠ äº†ä¸€ä¸ªæ–°çº¿ç¨‹ã€‚å› æ­¤ï¼Œä»¥ä¸Šä»£ç åœ¨å…¶é™æ€åˆå§‹åŒ–ç¨‹åºä¸­äº§ç”Ÿäº†ä¸€ä¸ªæ–°çº¿ç¨‹ã€‚æ–°çº¿ç¨‹å°†ä»å…¶çˆ¶çº§ç»§æ‰¿ä¸€äº›å±æ€§ï¼šä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼Œå¯ç»§æ‰¿çš„ThreadLocalså’Œä¸€äº›å®‰å…¨å±æ€§ï¼ˆè®¿é—®æƒé™ï¼‰ã€‚å› æ­¤ï¼Œå¾ˆå°‘å¸Œæœ›ä»¥ä¸å—æ§åˆ¶çš„æ–¹å¼è®¾ç½®è¿™äº›å±æ€§ã€‚ä¾‹å¦‚ï¼Œè¿™å¯èƒ½ä¼šé˜»æ­¢ç±»åŠ è½½å™¨çš„GCã€‚

é™æ€åˆå§‹åŒ–ç¨‹åºç”±é¦–å…ˆåŠ è½½ç±»çš„çº¿ç¨‹ï¼ˆåœ¨ä»»ä½•ç»™å®šçš„ClassLoaderä¸­ï¼‰æ‰§è¡Œï¼Œè¯¥çº¿ç¨‹å¯ä»¥æ˜¯ä¾‹å¦‚æ¥è‡ªWebæœåŠ¡å™¨çº¿ç¨‹æ± çš„å®Œå…¨éšæœºçš„çº¿ç¨‹ã€‚å¦‚æœè¦æ§åˆ¶è¿™äº›çº¿ç¨‹å±æ€§ï¼Œåˆ™å¿…é¡»åœ¨é™æ€æ–¹æ³•ä¸­å¯åŠ¨çº¿ç¨‹ï¼Œå¹¶æ§åˆ¶è°åœ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚
```
class Cache {
    private static Timer evictor;

	public static setupEvictor() {
		evictor = new Timer();
	}
}
```
### å–æ¶ˆäº†ä¿æŒçŠ¶æ€çš„è®¡æ—¶å™¨ä»»åŠ¡
```
final MyClass callback = this;
TimerTask task = new TimerTask() {
	public void run() {
		callback.timeout();
	}
};
timer.schedule(task, 300000L);

try {
	doSomething();
} finally {
	task.cancel();
}
```
ä¸Šé¢çš„ä»£ç ä½¿ç”¨è®¡æ—¶å™¨åœ¨doSomethingï¼ˆï¼‰ä¸Šå¼ºåˆ¶è¶…æ—¶ã€‚TimerTaskåŒ…å«ä¸€ä¸ªå¯¹å¤–éƒ¨ç±»çš„ï¼ˆéšå¼ï¼‰å®ä¾‹å¼•ç”¨ã€‚å› æ­¤ï¼Œåªè¦TimerTaskå­˜åœ¨ï¼Œå°±ä¸ä¼šå¯¹MyClassçš„å®ä¾‹è¿›è¡ŒGCå¤„ç†ã€‚ä¸å¹¸çš„æ˜¯ï¼ŒTimerå¯èƒ½ä¼šä¸€ç›´å–æ¶ˆè¢«å–æ¶ˆçš„TimerTasksï¼Œç›´åˆ°å®ƒä»¬çš„é¢„å®šè¶…æ—¶æ—¶é—´ç»“æŸï¼è¿™ä¼šä½¿ç¨‹åºæœ‰5åˆ†é’Ÿçš„æ—¶é—´æ‚¬ç©ºåœ°å¼•ç”¨MyClasså®ä¾‹ï¼Œåœ¨æ­¤æœŸé—´å®ƒæ— æ³•è¢«æ”¶é›†ï¼è¿™æ˜¯æš‚æ—¶çš„å†…å­˜æ³„æ¼ã€‚æ›´å¥½çš„TimerTaskä¼šè¦†ç›–cancelï¼ˆï¼‰æ–¹æ³•ï¼Œå¹¶åœ¨é‚£é‡Œå¼•ç”¨æ— æ•ˆã€‚å®ƒéœ€è¦æ›´å¤šçš„ä»£ç ã€‚
```
TimerTask task = new Job(this);
timer.schedule(task, 300000L);

try {
	doSomething();
} finally {
	task.cancel();
}


static class Job extends TimerTask {
	private volatile MyClass callback;

	public Job(MyClass callback) {
		this.callback = callback;
	}

	public boolean cancel() {
		callback = null;
		return super.cancel();
	}

	public void run() {
		MyClass cb = callback;
		if (cb == null) return;
		cb.timeout();
	}
}
```
### æ‹¥æœ‰å¯¹ClassLoaderå’Œæ— æ³•åˆ·æ–°çš„ç¼“å­˜çš„å¼ºå¤§å¼•ç”¨

åœ¨åƒåº”ç”¨ç¨‹åºæœåŠ¡å™¨æˆ–OSGIè¿™æ ·çš„åŠ¨æ€ç³»ç»Ÿä¸­ï¼Œåº”æ ¼å¤–å°å¿ƒï¼Œä¸è¦é˜»æ­¢ClassLoaderè¿›è¡Œåƒåœ¾å›æ”¶ã€‚åœ¨åº”ç”¨ç¨‹åºæœåŠ¡å™¨ä¸­å–æ¶ˆéƒ¨ç½²å’Œé‡æ–°éƒ¨ç½²å„ä¸ªåº”ç”¨ç¨‹åºæ—¶ï¼Œå°†ä¸ºå®ƒä»¬åˆ›å»ºæ–°çš„ç±»åŠ è½½å™¨ã€‚æ—§çš„æœªä½¿ç”¨ï¼Œåº”è¯¥æ”¶é›†ã€‚å¦‚æœä»å®¹å™¨ä»£ç åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºä»£ç ä¸­åªæœ‰ä¸€ä¸ªæ‚¬æŒ‚å¼•ç”¨ï¼Œé‚£ä¹ˆJavaä¸ä¼šè®©è¿™ç§æƒ…å†µå‘ç”Ÿã€‚

ç”±äºåœ¨æ•´ä¸ªä¼ä¸šåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨äº†å„ç§åº“ï¼Œå› æ­¤ç›´æ¥æ„å‘³ç€ï¼Œåº“åº”å°½å…¶æœ€å¤§åŠªåŠ›ï¼Œä¸è¦ä¿ç•™å¯¹å¯¹è±¡ï¼ˆä»¥åŠå®ƒä»¬çš„ç±»åŠ è½½å™¨ï¼‰çš„éè‡ªæ„¿å¼ºå¼•ç”¨ã€‚

è¿™ä¸å®¹æ˜“ã€‚è¯¸å¦‚`java.beans.Introspector`æ¥è‡ªJDKæˆ– `org.apache.commons.beanutils.PropertyUtils`æ¥è‡ªApache BeanUtilsæˆ– `org.springframework.beans.CachedIntrospectionResults`æ¥è‡ªSpringçš„ç±»å®ç°äº†ç¼“å­˜ï¼Œä»¥åŠ é€Ÿå…¶å†…éƒ¨å·¥ä½œã€‚å®ƒä»¬å¯¹æ‚¨ä¼ é€’ç»™å®ƒä»¬è¿›è¡Œåˆ†æçš„ç±»ä¿æŒå¼ºçƒˆçš„å¼•ç”¨ã€‚å¹¸è¿çš„æ˜¯ï¼Œå®ƒä»¬æä¾›äº†åˆ·æ–°å…¶ç¼“å­˜çš„æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œæ‰¾åˆ°æ‰€æœ‰å¯èƒ½å…·æœ‰å†…éƒ¨ç¼“å­˜çš„ç±»å¹¶åœ¨é€‚å½“çš„æ—¶é—´åˆ·æ–°å®ƒä»¬å¯¹äºå¼€å‘äººå‘˜æ¥è¯´å‡ ä¹æ˜¯ä¸å¯èƒ½çš„å·¥ä½œã€‚

å¦‚æœæ‚¨ç¢°å·§æ˜¯`org.apache.commons.el.BeanInfoManager`ä»Apache Commons EL ä½¿ç”¨çš„ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ³„æ¼ã€‚è¿™ä¸ªå¤è€çš„ç±»ä¿ç•™äº†å¼ºå¤§çš„å¼•ç”¨ç¼“å­˜ï¼Œè¿™äº›å¼•ç”¨åªä¼šåœ¨å†…å­˜ä¸è¶³ä¹‹å‰ä¸æ–­å¢é•¿ã€‚è€Œä¸”å®ƒæ²¡æœ‰å†²æ´—æ–¹æ³•ã€‚ç”šè‡³Tomcatä¹Ÿå¿…é¡»å®ç°ä¸€ç§æ¶‰åŠåå°„çš„ [å˜é€šåŠæ³•](http://issues.apache.org/bugzilla/attachment.cgi?id=18538&action=diff)ä»¥å¯¹å…¶è¿›è¡Œæ¸…ç†ã€‚

å¦‚æœè¿™äº›åº“é¦–å…ˆåªä½¿ç”¨è½¯å¼•ç”¨æˆ–å¼±å¼•ç”¨ï¼Œé‚£å°±æ›´å¥½äº†ã€‚å¿«é€Ÿæé†’ï¼š

è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨åœ¨å…¶ä¸ºé›¶çš„æ—¶é—´ç‚¹ä¸ŠåŸºæœ¬ä¸Šæœ‰æ‰€ä¸åŒã€‚

*   WeakReferenceï¼šåœ¨æœ€åä¸€ä¸ªå¯¹å¯¹è±¡çš„å¼ºå¼•ç”¨æ¶ˆå¤±æ—¶ï¼Œæˆ–å¤šæˆ–å°‘åŒæ—¶å°†å…¶ä¸ºnullã€‚å…¸å‹ç”¨äºç±»åŠ è½½å™¨å¼•ç”¨ï¼ˆå¦‚æœæ²¡æœ‰ç±»åŠ è½½å™¨ï¼Œåˆ™ç±»åŠ è½½å™¨æœ‰ä»€ä¹ˆç”¨ï¼‰ã€‚ä½†æ˜¯ï¼Œå¦‚æœ_åœ¨_ ClassLoaderå®ç°ä¸­ä½¿ç”¨å®ƒ_ï¼Œ_åˆ™è¦å°å¿ƒã€‚
*   SoftReferenceï¼šåªè¦å†…å­˜å…è®¸ï¼Œå³ä½¿æœ€åä¸€ä¸ªå¯¹å¯¹è±¡çš„å¼ºå¼•ç”¨æ¶ˆå¤±ï¼Œè¯¥å¼•ç”¨ä¹Ÿä¼šä¿ç•™ã€‚å…¸å‹ç”¨äºç¼“å­˜ã€‚

ä»…å½“åº“ä»…ä»å…¶è‡ªå·±çš„åŒ…ä¸­ç¼“å­˜å¯¹è±¡ï¼ˆæ²¡æœ‰å¤–éƒ¨å¼•ç”¨ï¼‰æ—¶ï¼Œæœ€å¥½ä¸ä½¿ç”¨è¿™äº›ç‰¹æ®Šå¼•ç”¨ï¼Œè€Œä»…ä½¿ç”¨æ™®é€šå¼•ç”¨ã€‚

ä½¿ç”¨è½¯å¼•ç”¨æˆ–å¼±å¼•ç”¨ä¹Ÿæœ‰åŠ©äºåº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶è¡Œä¸ºï¼šå¦‚æœå†…å­˜å˜ç´§ï¼Œåˆ™è¦åœ¨å†…å­˜ä¸ŠèŠ±è´¹çš„æœ€åä¸€ä»¶äº‹å°±æ˜¯ç¼“å­˜ã€‚å› æ­¤ï¼Œåƒåœ¾æ”¶é›†å™¨å°†åœ¨å¿…è¦æ—¶å›æ”¶ç¼“å­˜ä½¿ç”¨çš„å†…å­˜ã€‚è¿™é‡Œçš„ä¸€ä¸ªä¸å¥½çš„ä¾‹å­æ˜¯JBossçš„SQLè¯­å¥ç¼“å­˜ï¼šå®ƒæ˜¯å®Œå…¨é™æ€çš„ï¼Œå¹¶ä¸”å³ä½¿åœ¨å¾ˆç´§çš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥ä½¿ç”¨å¾ˆå¤šå†…å­˜ã€‚å¦ä¸€ä¸ªä¸å¥½çš„ä¾‹å­æ˜¯JBossçš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

è€Œä¸”ï¼Œæ¯ä¸ªé™æ€ç¼“å­˜éƒ½å¿…é¡»å§‹ç»ˆæä¾›ä¸€ç§åˆ·æ–°å…¶å†…å®¹çš„ç®€å•æ–¹æ³•ã€‚ï¼ˆå¹²å‡€çš„ï¼‰ç¼“å­˜ï¼ˆä¸ä¾‹å¦‚å†™å…¥ç¼“å­˜ç›¸åï¼‰çš„æœ¬è´¨æ˜¯å…¶å†…å®¹ä¸é‡è¦ï¼Œå¯ä»¥éšæ—¶å®‰å…¨åœ°ä¸¢å¼ƒã€‚ç¼“å­˜çš„é™åˆ¶æ˜¯å¦ä¸€ä¸ªé™·é˜±ã€‚é«˜é€Ÿç¼“å­˜æ°¸è¿œéƒ½ä¸ä¼šå˜å¤§ï¼Œä¹Ÿæ°¸è¿œä¸ä¼šé«˜é€Ÿç¼“å­˜å¯¹è±¡ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸ç³Ÿç³•çš„ç¤ºä¾‹ï¼Œå®ƒæ˜¯JDK DNSç¼“å­˜çš„é»˜è®¤è®¾ç½®ï¼ˆå®ƒå®Œå…¨å¿½ç•¥DNSè®°å½•çš„ç”Ÿå­˜æœŸï¼Œå¹¶å°†å¦å®šæŸ¥è¯¢æ°¸è¿œå­˜å‚¨åœ¨æ— è¾¹ç•Œåˆ—è¡¨ä¸­ï¼‰ã€‚æ‚¨çš„APIæ–‡æ¡£åº”è¯´æ˜æ˜¯å¦ä»¥åŠä½•æ—¶è¿›è¡Œç¼“å­˜ã€‚è¿™ä¹Ÿæœ‰åŠ©äºç”¨æˆ·ä¼°è®¡è¿è¡Œæ—¶æ€§èƒ½ã€‚

### åµŒå¥—åŒæ­¥è¯­å¥
```
class Message {
  private long id;
  ...
  public synchronized int compareTo(Message that) {
    synchronized (that) {
      return Long.compare(id, that.id);
    }
  }
}
```
ä¸Šé¢çš„ä»£ç æƒ³æä¾›ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„compareToï¼ˆï¼‰æ–¹æ³•ã€‚å¼€å‘äººå‘˜æ„è¯†åˆ°å¯¹idå­—æ®µçš„è®¿é—®éœ€è¦åœ¨æ‰€å±å®ä¾‹ä¸Šè¿›è¡ŒåŒæ­¥ã€‚å› æ­¤ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªåµŒå¥—çš„åŒæ­¥è¯­å¥ï¼Œä¸€ä¸ªç”¨äºä¿æŠ¤this.idï¼Œä¸€ä¸ªç”¨äºä¿æŠ¤that.idã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¯¥ä»£ç åœ¨è¢«å¤šä¸ªçº¿ç¨‹ä½¿ç”¨æ—¶ä¼šè¿…é€Ÿæ­»é”ã€‚æˆ‘ä»¬æƒ³åœ¨è¿™é‡Œæ”¯æŒå¤šçº¿ç¨‹ã€‚å½“çº¿ç¨‹1 `a.compareTo(b)`å’Œçº¿ç¨‹2éƒ½è¿™æ ·åšæ—¶ï¼Œ `b.compareTo(a)`å®ƒä»¬å°†å°è¯•ä»¥ç›¸åçš„é¡ºåºè·å¾—å¯¹aå’Œbçš„é”å®šï¼Œå¹¶ä¸”å°†æ­»é”ã€‚è®°ä½é”å®šè§„åˆ™ä¸€ï¼šæ‰€æœ‰çº¿ç¨‹å¿…é¡»å§‹ç»ˆä»¥ç›¸åŒçš„é¡ºåºè¿›è¡Œé”å®šã€‚æˆ‘ä»¬å¯ä»¥é‡å†™è¯¥æ–¹æ³•ï¼Œä»¥ä¾¿å®Œå…¨ä¸åµŒå¥—åŒæ­¥è¯­å¥ã€‚
```
public int compareTo(Message that) {
  long a;
  long b;
  synchronized (this) {
    a = this.id;
  }
  synchronized (that) {
    b = that.id;
  }
  return Long.compare(a, b);
}
```
### é€šè¿‡RandomAccessFileè¿›è¡Œéšæœºæ–‡ä»¶è®¿é—®
```
RandomAccessFile raf = new RandomAccessFile(f, "r");
for (...) {
  raf.seek(pos);
  byte b = raf.readByte();
}
```
å°½ç®¡å®ƒçš„åç§°å¦‚æ­¤ï¼Œä½†`java.io.RandomAccessFile`è¯¥ç±»ä¸å¤ªé€‚åˆä»¥éšæœºè®¿é—®çš„æ–¹å¼è®¿é—®æ–‡ä»¶ã€‚å³ï¼šæŸ¥æ‰¾ï¼Œè¯»å–ï¼ŒæŸ¥æ‰¾ï¼Œè¯»å–ç­‰ã€‚è¿™äº›å‘½ä»¤ä¸­çš„æ¯ä¸€ä¸ªéƒ½ç›´æ¥åœ¨æ–‡ä»¶æè¿°ç¬¦ä¸Šå‘å‡ºç›¸åº”çš„ç³»ç»Ÿè°ƒç”¨/ ioctlã€‚æ¯ä¸ªCç¨‹åºå‘˜éƒ½çŸ¥é“è¿™ç§æ–‡ä»¶è®¿é—®é€Ÿåº¦å¾ˆæ…¢ï¼Œåº”å°†å…¶æ›¿æ¢ä¸ºå†…å­˜æ˜ å°„æ–‡ä»¶è®¿é—®ã€‚æ‚¨å¯ä»¥é€šè¿‡MappedByteBufferåœ¨Javaä¸­å®Œæˆæ­¤æ“ä½œã€‚åœ¨æˆ‘çš„ç¬”è®°æœ¬ç”µè„‘ä¸Šï¼Œé€Ÿåº¦å¿«äº†50å€ã€‚
```
FileInputStream in = new FileInputStream(f);
MappedByteBuffer map = in.getChannel().map(MapMode.READ\_ONLY, 0, f.lengt());
for (...) {
  byte b = map.get(pos);
}
```